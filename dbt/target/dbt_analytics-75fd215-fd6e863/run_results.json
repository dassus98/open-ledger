{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.19", "generated_at": "2026-01-27T22:43:39.668241Z", "invocation_id": "5d9c096b-1207-4735-bb6c-4864254876f0", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-27T22:43:28.563594Z", "completed_at": "2026-01-27T22:43:28.570211Z"}, {"name": "execute", "started_at": "2026-01-27T22:43:28.600191Z", "completed_at": "2026-01-27T22:43:31.138503Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 2.680861473083496, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c20553-3203-ae15-0007-00220007ae16"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.openledger.staging_transactions", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT * FROM OPENLEDGER.RAW.transactions\n),\n\ncleaned AS (\n    SELECT\n        -- IDs\n        TRIM(transaction_id) AS transaction_id,\n        TRIM(user_id) AS user_id,\n        TRIM(merchant_id) AS merchant_id,\n\n        -- Numeric Conversion (Handle empty strings safely)\n        TRY_CAST(amount AS NUMBER(18, 2)) AS amount,\n        TRIM(currency) AS currency,\n\n        -- Status & Type\n        LOWER(TRIM(transaction_type)) AS transaction_type,\n        LOWER(TRIM(status)) AS status,\n\n        -- Timestamp Conversion\n        TRY_TO_TIMESTAMP(event_time) AS event_time\n\n    FROM source\n)\n\nSELECT * FROM cleaned", "relation_name": "OPENLEDGER.ANALYTICS.staging_transactions"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-27T22:43:28.554675Z", "completed_at": "2026-01-27T22:43:28.568236Z"}, {"name": "execute", "started_at": "2026-01-27T22:43:28.571478Z", "completed_at": "2026-01-27T22:43:31.154473Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.705923557281494, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c20553-3203-af15-0007-002200079356"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.openledger.staging_entries", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT * FROM OPENLEDGER.RAW.ledger_entries\n),\n\ncleaned AS (\n    SELECT\n        TRIM(entry_id) AS entry_id,\n        TRIM(transaction_id) AS transaction_id,\n        TRIM(account_id) AS account_id,\n        \n        -- Standardize types\n        LOWER(TRIM(account_type)) AS account_type,\n        LOWER(TRIM(entry_type)) AS entry_type,\n        \n        -- Safe conversions\n        TRY_CAST(amount AS NUMBER(18, 2)) AS amount,\n        TRY_TO_TIMESTAMP(event_time) AS event_time\n\n    FROM source\n)\n\nSELECT * FROM cleaned", "relation_name": "OPENLEDGER.ANALYTICS.staging_entries"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-27T22:43:28.561231Z", "completed_at": "2026-01-27T22:43:28.569101Z"}, {"name": "execute", "started_at": "2026-01-27T22:43:28.597145Z", "completed_at": "2026-01-27T22:43:31.156702Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.7116615772247314, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c20553-3203-af15-0007-00220007935a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.openledger.staging_settlements", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT * FROM OPENLEDGER.RAW.settlements\n),\n\ncleaned AS (\n    SELECT\n        TRIM(settlement_id) AS settlement_id,\n        TRIM(transaction_id) AS transaction_id,\n        TRIM(merchant_id) AS merchant_id,\n\n        -- Financials\n        TRY_CAST(gross_amount AS NUMBER(18, 2)) AS gross_amount,\n        TRY_CAST(fee_amount AS NUMBER(18, 2)) AS fee_amount,\n        TRY_CAST(net_amount AS NUMBER(18, 2)) AS net_amount,\n        TRIM(currency) AS currency,\n\n        -- Dates & Status\n        TRY_TO_DATE(settlement_date) AS settlement_date,\n        TRIM(processor_reference) AS processor_reference,\n        LOWER(TRIM(status)) AS status,\n        TRIM(discrepancy_reason) AS discrepancy_reason\n\n    FROM source\n)\n\nSELECT * FROM cleaned", "relation_name": "OPENLEDGER.ANALYTICS.staging_settlements"}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-27T22:43:31.289179Z", "completed_at": "2026-01-27T22:43:31.299384Z"}, {"name": "execute", "started_at": "2026-01-27T22:43:31.334332Z", "completed_at": "2026-01-27T22:43:33.767652Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.578944683074951, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c20553-3203-ae15-0007-00220007ae22"}, "message": null, "failures": 0, "unique_id": "test.openledger.not_null_staging_transactions_transaction_id.d4f9e42898", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect transaction_id\nfrom OPENLEDGER.ANALYTICS.staging_transactions\nwhere transaction_id is null\n\n\n", "relation_name": null}, {"status": "warn", "timing": [{"name": "compile", "started_at": "2026-01-27T22:43:31.242080Z", "completed_at": "2026-01-27T22:43:31.256279Z"}, {"name": "execute", "started_at": "2026-01-27T22:43:31.278015Z", "completed_at": "2026-01-27T22:43:33.785342Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 2.6556949615478516, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c20553-3203-ae15-0007-00220007ae1e"}, "message": "Got 72 results, configured to warn if != 0", "failures": 72, "unique_id": "test.openledger.not_null_staging_transactions_amount.39c556e413", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect amount\nfrom OPENLEDGER.ANALYTICS.staging_transactions\nwhere amount is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-27T22:43:31.237830Z", "completed_at": "2026-01-27T22:43:31.255187Z"}, {"name": "execute", "started_at": "2026-01-27T22:43:31.263001Z", "completed_at": "2026-01-27T22:43:33.835810Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.7134487628936768, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c20553-3203-ae15-0007-00220007ae1a"}, "message": null, "failures": 0, "unique_id": "test.openledger.accepted_values_staging_transactions_status__completed__failed__pending__declined.36daace0a3", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        status as value_field,\n        count(*) as n_records\n\n    from OPENLEDGER.ANALYTICS.staging_transactions\n    group by status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'completed','failed','pending','declined'\n)\n\n\n", "relation_name": null}, {"status": "warn", "timing": [{"name": "compile", "started_at": "2026-01-27T22:43:31.295439Z", "completed_at": "2026-01-27T22:43:31.320692Z"}, {"name": "execute", "started_at": "2026-01-27T22:43:31.338544Z", "completed_at": "2026-01-27T22:43:33.908539Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.7130048274993896, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c20553-3203-af15-0007-00220007935e"}, "message": "Got 67 results, configured to warn if != 0", "failures": 67, "unique_id": "test.openledger.not_null_staging_transactions_user_id.6e7b530ec6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom OPENLEDGER.ANALYTICS.staging_transactions\nwhere user_id is null\n\n\n", "relation_name": null}, {"status": "warn", "timing": [{"name": "compile", "started_at": "2026-01-27T22:43:33.865402Z", "completed_at": "2026-01-27T22:43:33.870397Z"}, {"name": "execute", "started_at": "2026-01-27T22:43:33.871238Z", "completed_at": "2026-01-27T22:43:36.307327Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.5391359329223633, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c20553-3203-ae15-0007-00220007ae26"}, "message": "Got 72 results, configured to warn if != 0", "failures": 72, "unique_id": "test.openledger.unique_staging_transactions_transaction_id.fdabedfb57", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    transaction_id as unique_field,\n    count(*) as n_records\n\nfrom OPENLEDGER.ANALYTICS.staging_transactions\nwhere transaction_id is not null\ngroup by transaction_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "warn", "timing": [{"name": "compile", "started_at": "2026-01-27T22:43:33.953699Z", "completed_at": "2026-01-27T22:43:33.961114Z"}, {"name": "execute", "started_at": "2026-01-27T22:43:33.962599Z", "completed_at": "2026-01-27T22:43:36.456891Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.5963776111602783, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c20553-3203-ae15-0007-00220007ae2a"}, "message": "Got 31 results, configured to warn if != 0", "failures": 31, "unique_id": "test.openledger.relationships_staging_settlements_transaction_id__transaction_id__ref_staging_transactions_.90aad845a5", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select transaction_id as from_field\n    from OPENLEDGER.ANALYTICS.staging_settlements\n    where transaction_id is not null\n),\n\nparent as (\n    select transaction_id as to_field\n    from OPENLEDGER.ANALYTICS.staging_transactions\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-27T22:43:33.896079Z", "completed_at": "2026-01-27T22:43:33.901466Z"}, {"name": "execute", "started_at": "2026-01-27T22:43:33.902847Z", "completed_at": "2026-01-27T22:43:36.433041Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 2.6560981273651123, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c20553-3203-af15-0007-002200079362"}, "message": null, "failures": 0, "unique_id": "test.openledger.not_null_staging_settlements_settlement_id.1b418a3038", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect settlement_id\nfrom OPENLEDGER.ANALYTICS.staging_settlements\nwhere settlement_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-27T22:43:34.003537Z", "completed_at": "2026-01-27T22:43:34.008036Z"}, {"name": "execute", "started_at": "2026-01-27T22:43:34.008924Z", "completed_at": "2026-01-27T22:43:36.451902Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.5516910552978516, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c20553-3203-af15-0007-002200079366"}, "message": null, "failures": 0, "unique_id": "test.openledger.unique_staging_settlements_settlement_id.3d20d2e433", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    settlement_id as unique_field,\n    count(*) as n_records\n\nfrom OPENLEDGER.ANALYTICS.staging_settlements\nwhere settlement_id is not null\ngroup by settlement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-27T22:43:36.558359Z", "completed_at": "2026-01-27T22:43:36.563733Z"}, {"name": "execute", "started_at": "2026-01-27T22:43:36.564954Z", "completed_at": "2026-01-27T22:43:39.570102Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.1032016277313232, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c20553-3203-ae15-0007-00220007ae2e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.openledger.fct_transactions", "compiled": true, "compiled_code": "\n\nWITH internal AS (\n    SELECT * FROM OPENLEDGER.ANALYTICS.staging_transactions\n),\n\nexternal AS (\n    SELECT * FROM OPENLEDGER.ANALYTICS.staging_settlements\n),\n\njoined AS (\n    SELECT\n        -- COALESCE ensures we keep the ID even if it's missing from one side\n        COALESCE(i.transaction_id, e.transaction_id) AS transaction_id,\n        \n        -- Dimensions\n        i.user_id,\n        i.merchant_id,\n        i.event_time AS transaction_at,\n        e.settlement_date,\n        \n        -- Metrics\n        i.amount AS internal_amount,\n        e.net_amount AS bank_settled_amount,\n        e.fee_amount AS bank_fee,\n        \n        -- Calculating the difference (0 == perfect match)\n        -- Handling null values by treating them as 0\n        ZEROIFNULL(e.net_amount) - ZEROIFNULL(i.amount) AS reconciliation_delta\n        \n    FROM internal i\n    FULL OUTER JOIN external e \n        ON i.transaction_id = e.transaction_id\n)\n\nSELECT\n    *,\n    CASE\n        WHEN internal_amount IS NOT NULL AND bank_settled_amount IS NULL THEN 'MISSING_EXTERNAL'\n        WHEN internal_amount IS NULL AND bank_settled_amount IS NOT NULL THEN 'MISSING_INTERNAL'\n        WHEN internal_amount = bank_settled_amount THEN 'MATCHED'\n        ELSE 'DISCREPANCY'\n    END AS reconciliation_status\nFROM joined", "relation_name": "OPENLEDGER.ANALYTICS.fct_transactions"}], "elapsed_time": 17.654170274734497, "args": {"log_level": "info", "static_parser": true, "populate_cache": true, "resource_types": [], "defer": false, "send_anonymous_usage_stats": false, "introspect": true, "profiles_dir": "/home/dchit/projects/open-ledger/dbt", "vars": {}, "partial_parse": true, "strict_mode": false, "indirect_selection": "eager", "log_file_max_bytes": 10485760, "log_format_file": "json", "use_colors_file": true, "enable_legacy_logger": false, "favor_state": false, "print": true, "project_dir": "/home/dchit/projects/open-ledger/dbt", "include_saved_query": false, "cache_selected_only": false, "require_explicit_package_overrides_for_builtin_materializations": false, "target_path": "target/dbt_analytics-75fd215-fd6e863", "printer_width": 80, "version_check": true, "warn_error_options": {"include": [], "exclude": []}, "log_format": "json", "partial_parse_file_diff": true, "show_resource_report": false, "quiet": false, "show": false, "log_path": "/home/dchit/projects/open-ledger/dbt/target/dbt_analytics-75fd215-fd6e863", "log_level_file": "debug", "macro_debugging": false, "use_colors": true, "write_json": true, "invocation_command": "dbt build --select fqn:*", "which": "build", "exclude": [], "select": ["fqn:*"]}}