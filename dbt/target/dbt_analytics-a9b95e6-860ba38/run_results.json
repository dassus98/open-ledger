{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.19", "generated_at": "2026-01-27T22:41:21.694949Z", "invocation_id": "d26f8bde-95c4-4d6f-8c92-890afb15b101", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-27T22:41:13.488292Z", "completed_at": "2026-01-27T22:41:13.496764Z"}, {"name": "execute", "started_at": "2026-01-27T22:41:13.522285Z", "completed_at": "2026-01-27T22:41:16.081705Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.7073631286621094, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c20551-3203-ae15-0007-00220007adea"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.openledger.staging_settlements", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT * FROM OPENLEDGER.RAW.settlements\n),\n\ncleaned AS (\n    SELECT\n        TRIM(settlement_id) AS settlement_id,\n        TRIM(transaction_id) AS transaction_id,\n        TRIM(merchant_id) AS merchant_id,\n\n        -- Financials\n        TRY_CAST(gross_amount AS NUMBER(18, 2)) AS gross_amount,\n        TRY_CAST(fee_amount AS NUMBER(18, 2)) AS fee_amount,\n        TRY_CAST(net_amount AS NUMBER(18, 2)) AS net_amount,\n        TRIM(currency) AS currency,\n\n        -- Dates & Status\n        TRY_TO_DATE(settlement_date) AS settlement_date,\n        TRIM(processor_reference) AS processor_reference,\n        LOWER(TRIM(status)) AS status,\n        TRIM(discrepancy_reason) AS discrepancy_reason\n\n    FROM source\n)\n\nSELECT * FROM cleaned", "relation_name": "OPENLEDGER.ANALYTICS.staging_settlements"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-27T22:41:13.491032Z", "completed_at": "2026-01-27T22:41:13.497225Z"}, {"name": "execute", "started_at": "2026-01-27T22:41:13.525260Z", "completed_at": "2026-01-27T22:41:16.342029Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 2.9634151458740234, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c20551-3203-af15-0007-002200079322"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.openledger.staging_transactions", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT * FROM OPENLEDGER.RAW.transactions\n),\n\ncleaned AS (\n    SELECT\n        -- IDs\n        TRIM(transaction_id) AS transaction_id,\n        TRIM(user_id) AS user_id,\n        TRIM(merchant_id) AS merchant_id,\n\n        -- Numeric Conversion (Handle empty strings safely)\n        TRY_CAST(amount AS NUMBER(18, 2)) AS amount,\n        TRIM(currency) AS currency,\n\n        -- Status & Type\n        LOWER(TRIM(transaction_type)) AS transaction_type,\n        LOWER(TRIM(status)) AS status,\n\n        -- Timestamp Conversion\n        TRY_TO_TIMESTAMP(event_time) AS event_time\n\n    FROM source\n)\n\nSELECT * FROM cleaned", "relation_name": "OPENLEDGER.ANALYTICS.staging_transactions"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-27T22:41:13.482151Z", "completed_at": "2026-01-27T22:41:13.496189Z"}, {"name": "execute", "started_at": "2026-01-27T22:41:13.499085Z", "completed_at": "2026-01-27T22:41:16.339698Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.9671878814697266, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c20551-3203-af15-0007-00220007931e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.openledger.staging_entries", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT * FROM OPENLEDGER.RAW.ledger_entries\n),\n\ncleaned AS (\n    SELECT\n        TRIM(entry_id) AS entry_id,\n        TRIM(transaction_id) AS transaction_id,\n        TRIM(account_id) AS account_id,\n        \n        -- Standardize types\n        LOWER(TRIM(account_type)) AS account_type,\n        LOWER(TRIM(entry_type)) AS entry_type,\n        \n        -- Safe conversions\n        TRY_CAST(amount AS NUMBER(18, 2)) AS amount,\n        TRY_TO_TIMESTAMP(event_time) AS event_time\n\n    FROM source\n)\n\nSELECT * FROM cleaned", "relation_name": "OPENLEDGER.ANALYTICS.staging_entries"}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-27T22:41:16.192840Z", "completed_at": "2026-01-27T22:41:16.209587Z"}, {"name": "execute", "started_at": "2026-01-27T22:41:16.210529Z", "completed_at": "2026-01-27T22:41:18.820261Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.721024990081787, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c20551-3203-ae15-0007-00220007adee"}, "message": null, "failures": 0, "unique_id": "test.openledger.not_null_staging_settlements_settlement_id.1b418a3038", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect settlement_id\nfrom OPENLEDGER.ANALYTICS.staging_settlements\nwhere settlement_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-27T22:41:16.203935Z", "completed_at": "2026-01-27T22:41:16.215721Z"}, {"name": "execute", "started_at": "2026-01-27T22:41:16.334902Z", "completed_at": "2026-01-27T22:41:18.954044Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.8540244102478027, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c20551-3203-af15-0007-002200079326"}, "message": null, "failures": 0, "unique_id": "test.openledger.unique_staging_settlements_settlement_id.3d20d2e433", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    settlement_id as unique_field,\n    count(*) as n_records\n\nfrom OPENLEDGER.ANALYTICS.staging_settlements\nwhere settlement_id is not null\ngroup by settlement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "fail", "timing": [{"name": "compile", "started_at": "2026-01-27T22:41:16.461366Z", "completed_at": "2026-01-27T22:41:16.467389Z"}, {"name": "execute", "started_at": "2026-01-27T22:41:16.472581Z", "completed_at": "2026-01-27T22:41:18.974180Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.6258442401885986, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c20551-3203-af15-0007-00220007932a"}, "message": "Got 72 results, configured to fail if != 0", "failures": 72, "unique_id": "test.openledger.not_null_staging_transactions_amount.39c556e413", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect amount\nfrom OPENLEDGER.ANALYTICS.staging_transactions\nwhere amount is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-27T22:41:16.453188Z", "completed_at": "2026-01-27T22:41:16.466048Z"}, {"name": "execute", "started_at": "2026-01-27T22:41:16.470261Z", "completed_at": "2026-01-27T22:41:18.978393Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 2.6421384811401367, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c20551-3203-af15-0007-00220007932e"}, "message": null, "failures": 0, "unique_id": "test.openledger.accepted_values_staging_transactions_status__completed__failed__pending__declined.36daace0a3", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        status as value_field,\n        count(*) as n_records\n\n    from OPENLEDGER.ANALYTICS.staging_transactions\n    group by status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'completed','failed','pending','declined'\n)\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-27T22:41:18.914671Z", "completed_at": "2026-01-27T22:41:18.918594Z"}, {"name": "execute", "started_at": "2026-01-27T22:41:18.919659Z", "completed_at": "2026-01-27T22:41:21.352705Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.5303871631622314, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c20551-3203-ae15-0007-00220007adf2"}, "message": null, "failures": 0, "unique_id": "test.openledger.not_null_staging_transactions_transaction_id.d4f9e42898", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect transaction_id\nfrom OPENLEDGER.ANALYTICS.staging_transactions\nwhere transaction_id is null\n\n\n", "relation_name": null}, {"status": "warn", "timing": [{"name": "compile", "started_at": "2026-01-27T22:41:19.048419Z", "completed_at": "2026-01-27T22:41:19.054265Z"}, {"name": "execute", "started_at": "2026-01-27T22:41:19.055289Z", "completed_at": "2026-01-27T22:41:21.459305Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.5020906925201416, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c20551-3203-af15-0007-002200079332"}, "message": "Got 67 results, configured to warn if != 0", "failures": 67, "unique_id": "test.openledger.not_null_staging_transactions_user_id.6e7b530ec6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom OPENLEDGER.ANALYTICS.staging_transactions\nwhere user_id is null\n\n\n", "relation_name": null}, {"status": "warn", "timing": [{"name": "compile", "started_at": "2026-01-27T22:41:19.102016Z", "completed_at": "2026-01-27T22:41:19.109316Z"}, {"name": "execute", "started_at": "2026-01-27T22:41:19.110981Z", "completed_at": "2026-01-27T22:41:21.551380Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 2.541865348815918, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c20551-3203-ae15-0007-00220007adf6"}, "message": "Got 72 results, configured to warn if != 0", "failures": 72, "unique_id": "test.openledger.unique_staging_transactions_transaction_id.fdabedfb57", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    transaction_id as unique_field,\n    count(*) as n_records\n\nfrom OPENLEDGER.ANALYTICS.staging_transactions\nwhere transaction_id is not null\ngroup by transaction_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "warn", "timing": [{"name": "compile", "started_at": "2026-01-27T22:41:19.080436Z", "completed_at": "2026-01-27T22:41:19.090804Z"}, {"name": "execute", "started_at": "2026-01-27T22:41:19.094686Z", "completed_at": "2026-01-27T22:41:21.596460Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.6059391498565674, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c20551-3203-af15-0007-002200079336"}, "message": "Got 31 results, configured to warn if != 0", "failures": 31, "unique_id": "test.openledger.relationships_staging_settlements_transaction_id__transaction_id__ref_staging_transactions_.90aad845a5", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select transaction_id as from_field\n    from OPENLEDGER.ANALYTICS.staging_settlements\n    where transaction_id is not null\n),\n\nparent as (\n    select transaction_id as to_field\n    from OPENLEDGER.ANALYTICS.staging_transactions\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-4 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.openledger.fct_transactions", "compiled": false, "compiled_code": null, "relation_name": "OPENLEDGER.ANALYTICS.fct_transactions"}], "elapsed_time": 14.684609174728394, "args": {"log_file_max_bytes": 10485760, "printer_width": 80, "write_json": true, "macro_debugging": false, "use_colors_file": true, "quiet": false, "indirect_selection": "eager", "send_anonymous_usage_stats": false, "log_level_file": "debug", "enable_legacy_logger": false, "version_check": true, "which": "build", "select": ["fqn:*"], "project_dir": "/home/dchit/projects/open-ledger/dbt", "show": false, "log_path": "/home/dchit/projects/open-ledger/dbt/target/dbt_analytics-a9b95e6-860ba38", "warn_error_options": {"include": [], "exclude": []}, "partial_parse_file_diff": true, "require_explicit_package_overrides_for_builtin_materializations": false, "static_parser": true, "vars": {}, "partial_parse": true, "use_colors": true, "exclude": [], "favor_state": false, "log_format": "json", "include_saved_query": false, "show_resource_report": false, "target_path": "target/dbt_analytics-a9b95e6-860ba38", "populate_cache": true, "defer": false, "print": true, "cache_selected_only": false, "resource_types": [], "invocation_command": "dbt build --select fqn:*", "strict_mode": false, "profiles_dir": "/home/dchit/projects/open-ledger/dbt", "log_level": "info", "introspect": true, "log_format_file": "json"}}