{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.19", "generated_at": "2026-01-27T22:08:02.940713Z", "invocation_id": "8a27de4d-955e-4467-96f7-b0700ea4766d", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-27T22:08:02.844404Z", "completed_at": "2026-01-27T22:08:02.849685Z"}, {"name": "execute", "started_at": "2026-01-27T22:08:02.851319Z", "completed_at": "2026-01-27T22:08:02.851345Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.017051219940185547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.openledger.staging_settlements", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT * FROM OPENLEDGER.RAW.settlements\n),\n\ncleaned AS (\n    SELECT\n        TRIM(settlement_id) AS settlement_id,\n        TRIM(transaction_id) AS transaction_id,\n        TRIM(merchant_id) AS merchant_id,\n\n        -- Financials\n        TRY_CAST(gross_amount AS NUMBER(18, 2)) AS gross_amount,\n        TRY_CAST(fee_amount AS NUMBER(18, 2)) AS fee_amount,\n        TRY_CAST(net_amount AS NUMBER(18, 2)) AS net_amount,\n        TRIM(currency) AS currency,\n\n        -- Dates & Status\n        TRY_TO_DATE(settlement_date) AS settlement_date,\n        TRIM(processor_reference) AS processor_reference,\n        LOWER(TRIM(status)) AS status,\n        TRIM(discrepancy_reason) AS discrepancy_reason\n\n    FROM source\n)\n\nSELECT * FROM cleaned", "relation_name": "OPENLEDGER.ANALYTICS.staging_settlements"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-27T22:08:02.839250Z", "completed_at": "2026-01-27T22:08:02.850616Z"}, {"name": "execute", "started_at": "2026-01-27T22:08:02.854180Z", "completed_at": "2026-01-27T22:08:02.854187Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.020437955856323242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.openledger.staging_entries", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT * FROM OPENLEDGER.RAW.ledger_entries\n),\n\ncleaned AS (\n    SELECT\n        TRIM(entry_id) AS entry_id,\n        TRIM(transaction_id) AS transaction_id,\n        TRIM(account_id) AS account_id,\n        \n        -- Standardize types\n        LOWER(TRIM(account_type)) AS account_type,\n        LOWER(TRIM(entry_type)) AS entry_type,\n        \n        -- Safe conversions\n        TRY_CAST(amount AS NUMBER(18, 2)) AS amount,\n        TRY_TO_TIMESTAMP(event_time) AS event_time\n\n    FROM source\n)\n\nSELECT * FROM cleaned", "relation_name": "OPENLEDGER.ANALYTICS.staging_entries"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-27T22:08:02.846763Z", "completed_at": "2026-01-27T22:08:02.851760Z"}, {"name": "execute", "started_at": "2026-01-27T22:08:02.854955Z", "completed_at": "2026-01-27T22:08:02.854961Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.021005630493164062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.openledger.staging_transactions", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT * FROM OPENLEDGER.RAW.transactions\n),\n\ncleaned AS (\n    SELECT\n        -- IDs\n        TRIM(transaction_id) AS transaction_id,\n        TRIM(user_id) AS user_id,\n        TRIM(merchant_id) AS merchant_id,\n\n        -- Numeric Conversion (Handle empty strings safely)\n        TRY_CAST(amount AS NUMBER(18, 2)) AS amount,\n        TRIM(currency) AS currency,\n\n        -- Status & Type\n        LOWER(TRIM(transaction_type)) AS transaction_type,\n        LOWER(TRIM(status)) AS status,\n\n        -- Timestamp Conversion\n        TRY_TO_TIMESTAMP(event_time) AS event_time\n\n    FROM source\n)\n\nSELECT * FROM cleaned", "relation_name": "OPENLEDGER.ANALYTICS.staging_transactions"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-27T22:08:02.865743Z", "completed_at": "2026-01-27T22:08:02.885449Z"}, {"name": "execute", "started_at": "2026-01-27T22:08:02.898282Z", "completed_at": "2026-01-27T22:08:02.898293Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03937840461730957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.openledger.not_null_staging_settlements_settlement_id.1b418a3038", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect settlement_id\nfrom OPENLEDGER.ANALYTICS.staging_settlements\nwhere settlement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-27T22:08:02.878631Z", "completed_at": "2026-01-27T22:08:02.888365Z"}, {"name": "execute", "started_at": "2026-01-27T22:08:02.898989Z", "completed_at": "2026-01-27T22:08:02.898994Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03921341896057129, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.openledger.unique_staging_settlements_settlement_id.3d20d2e433", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    settlement_id as unique_field,\n    count(*) as n_records\n\nfrom OPENLEDGER.ANALYTICS.staging_settlements\nwhere settlement_id is not null\ngroup by settlement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-27T22:08:02.886232Z", "completed_at": "2026-01-27T22:08:02.897832Z"}, {"name": "execute", "started_at": "2026-01-27T22:08:02.901370Z", "completed_at": "2026-01-27T22:08:02.901451Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03849434852600098, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.openledger.fct_transactions", "compiled": true, "compiled_code": "\n\nWITH internal AS (\n    SELECT * FROM OPENLEDGER.ANALYTICS.staging_transactions\n),\n\nexternal AS (\n    SELECT * FROM OPENLEDGER.ANALYTICS.staging_settlements\n),\n\njoined AS (\n    SELECT\n        -- COALESCE ensures we keep the ID even if it's missing from one side\n        COALESCE(i.transaction_id, e.transaction_id) AS transaction_id,\n        \n        -- Dimensions\n        i.user_id,\n        i.merchant_id,\n        i.event_time AS transaction_at,\n        e.settlement_date,\n        \n        -- Metrics\n        i.amount AS internal_amount,\n        e.net_amount AS bank_settled_amount,\n        e.fee_amount AS bank_fee,\n        \n        -- Calculating the difference (0 == perfect match)\n        -- Handling null values by treating them as 0\n        ZEROIFNULL(e.net_amount) - ZEROIFNULL(i.amount) AS reconciliation_delta\n        \n    FROM internal i\n    FULL OUTER JOIN external e \n        ON i.transaction_id = e.transaction_id\n)\n\nSELECT\n    *,\n    CASE\n        WHEN internal_amount IS NOT NULL AND bank_settled_amount IS NULL THEN 'MISSING_EXTERNAL'\n        WHEN internal_amount IS NULL AND bank_settled_amount IS NOT NULL THEN 'MISSING_INTERNAL'\n        WHEN internal_amount = bank_settled_amount THEN 'MATCHED'\n        ELSE 'DISCREPANCY'\n    END AS reconciliation_status\nFROM joined", "relation_name": "OPENLEDGER.ANALYTICS.fct_transactions"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-27T22:08:02.888961Z", "completed_at": "2026-01-27T22:08:02.898627Z"}, {"name": "execute", "started_at": "2026-01-27T22:08:02.902523Z", "completed_at": "2026-01-27T22:08:02.902529Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.026909589767456055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.openledger.accepted_values_staging_transactions_status__completed__failed__pending__declined.36daace0a3", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        status as value_field,\n        count(*) as n_records\n\n    from OPENLEDGER.ANALYTICS.staging_transactions\n    group by status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'completed','failed','pending','declined'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-27T22:08:02.907720Z", "completed_at": "2026-01-27T22:08:02.918382Z"}, {"name": "execute", "started_at": "2026-01-27T22:08:02.926267Z", "completed_at": "2026-01-27T22:08:02.926276Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.024037837982177734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.openledger.not_null_staging_transactions_amount.39c556e413", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect amount\nfrom OPENLEDGER.ANALYTICS.staging_transactions\nwhere amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-27T22:08:02.911371Z", "completed_at": "2026-01-27T22:08:02.919029Z"}, {"name": "execute", "started_at": "2026-01-27T22:08:02.926642Z", "completed_at": "2026-01-27T22:08:02.926648Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02343130111694336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.openledger.not_null_staging_transactions_transaction_id.d4f9e42898", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect transaction_id\nfrom OPENLEDGER.ANALYTICS.staging_transactions\nwhere transaction_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-27T22:08:02.915419Z", "completed_at": "2026-01-27T22:08:02.925696Z"}, {"name": "execute", "started_at": "2026-01-27T22:08:02.929606Z", "completed_at": "2026-01-27T22:08:02.929617Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.024590730667114258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.openledger.not_null_staging_transactions_user_id.6e7b530ec6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom OPENLEDGER.ANALYTICS.staging_transactions\nwhere user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-27T22:08:02.919598Z", "completed_at": "2026-01-27T22:08:02.927001Z"}, {"name": "execute", "started_at": "2026-01-27T22:08:02.931056Z", "completed_at": "2026-01-27T22:08:02.931067Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.022230863571166992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.openledger.relationships_staging_settlements_transaction_id__transaction_id__ref_staging_transactions_.90aad845a5", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select transaction_id as from_field\n    from OPENLEDGER.ANALYTICS.staging_settlements\n    where transaction_id is not null\n),\n\nparent as (\n    select transaction_id as to_field\n    from OPENLEDGER.ANALYTICS.staging_transactions\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-27T22:08:02.933924Z", "completed_at": "2026-01-27T22:08:02.936531Z"}, {"name": "execute", "started_at": "2026-01-27T22:08:02.937076Z", "completed_at": "2026-01-27T22:08:02.937081Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005362987518310547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.openledger.unique_staging_transactions_transaction_id.fdabedfb57", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    transaction_id as unique_field,\n    count(*) as n_records\n\nfrom OPENLEDGER.ANALYTICS.staging_transactions\nwhere transaction_id is not null\ngroup by transaction_id\nhaving count(*) > 1\n\n\n", "relation_name": null}], "elapsed_time": 4.154710292816162, "args": {"log_format_file": "debug", "warn_error_options": {"include": [], "exclude": []}, "version_check": true, "log_level": "info", "write_json": true, "populate_cache": true, "cache_selected_only": false, "indirect_selection": "eager", "quiet": false, "favor_state": false, "partial_parse_file_diff": true, "static": false, "compile": true, "introspect": true, "which": "generate", "send_anonymous_usage_stats": true, "use_colors_file": true, "log_file_max_bytes": 10485760, "partial_parse": true, "use_colors": true, "profiles_dir": "/home/dchit/projects/open-ledger/dbt", "enable_legacy_logger": false, "strict_mode": false, "show_resource_report": false, "log_level_file": "debug", "invocation_command": "dbt docs generate", "print": true, "project_dir": "/home/dchit/projects/open-ledger/dbt", "exclude": [], "empty_catalog": false, "log_format": "default", "static_parser": true, "vars": {}, "select": [], "log_path": "/home/dchit/projects/open-ledger/dbt/logs", "printer_width": 80, "require_explicit_package_overrides_for_builtin_materializations": false, "defer": false, "macro_debugging": false}}