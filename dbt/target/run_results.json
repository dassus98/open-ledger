{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.19", "generated_at": "2026-01-30T22:11:25.606201Z", "invocation_id": "91dcc89d-7806-4a4b-a224-67ec9ee61eac", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-30T22:11:21.668706Z", "completed_at": "2026-01-30T22:11:21.674121Z"}, {"name": "execute", "started_at": "2026-01-30T22:11:21.674774Z", "completed_at": "2026-01-30T22:11:25.510741Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.9336957931518555, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c21613-3203-b2c0-0007-00220008001e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.openledger.fct_transactions", "compiled": true, "compiled_code": "\n\nWITH internal AS (\n    SELECT * FROM OPENLEDGER.ANALYTICS.staging_transactions\n),\n\nexternal AS (\n    SELECT * FROM OPENLEDGER.ANALYTICS.staging_settlements\n),\n\njoined AS (\n    SELECT\n        -- COALESCE ensures we keep the ID even if it's missing from one side\n        COALESCE(i.transaction_id, e.transaction_id) AS transaction_id,\n        \n        -- Dimensions\n        i.user_id,\n        i.merchant_id,\n        i.event_time AS transaction_at,\n        e.settlement_date,\n        \n        -- Metrics\n        i.amount AS internal_amount,\n        e.net_amount AS bank_settled_amount,\n        e.fee_amount AS bank_fee,\n        \n        -- Calculating the difference (0 == perfect match)\n        -- Handling null values by treating them as 0\n        ZEROIFNULL(e.net_amount) - ZEROIFNULL(i.amount) AS reconciliation_delta\n        \n    FROM internal i\n    FULL OUTER JOIN external e \n        ON i.transaction_id = e.transaction_id\n)\n\nSELECT\n    *,\n    CASE\n        WHEN internal_amount IS NOT NULL AND bank_settled_amount IS NULL THEN 'MISSING_EXTERNAL'\n        WHEN internal_amount IS NULL AND bank_settled_amount IS NOT NULL THEN 'MISSING_INTERNAL'\n        WHEN internal_amount = bank_settled_amount THEN 'MATCHED'\n        ELSE 'DISCREPANCY'\n    END AS reconciliation_status\nFROM joined", "relation_name": "OPENLEDGER.ANALYTICS.fct_transactions"}], "elapsed_time": 10.529974699020386, "args": {"show": false, "project_dir": "/home/dchit/projects/open-ledger/dbt", "use_colors": true, "version_check": true, "indirect_selection": "eager", "log_path": "/home/dchit/projects/open-ledger/dbt/logs", "cache_selected_only": false, "log_level_file": "debug", "which": "build", "log_format_file": "debug", "send_anonymous_usage_stats": true, "resource_types": [], "vars": {}, "strict_mode": false, "use_colors_file": true, "static_parser": true, "print": true, "macro_debugging": false, "warn_error_options": {"include": [], "exclude": []}, "require_explicit_package_overrides_for_builtin_materializations": false, "log_format": "default", "log_level": "info", "exclude": [], "profiles_dir": "/home/dchit/projects/open-ledger/dbt", "partial_parse_file_diff": true, "select": ["fct_transactions"], "partial_parse": true, "populate_cache": true, "log_file_max_bytes": 10485760, "introspect": true, "write_json": true, "invocation_command": "dbt build --select fct_transactions", "show_resource_report": false, "quiet": false, "defer": false, "favor_state": false, "include_saved_query": false, "printer_width": 80, "enable_legacy_logger": false}}