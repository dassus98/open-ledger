[0m16:05:20.078341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc2518f5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc250cbaa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc2509e11f0>]}


============================== 16:05:20.081463 | aec7b1e7-480a-4a21-9c6d-cf267d9338bf ==============================
[0m16:05:20.081463 [info ] [MainThread]: Running with dbt=1.7.19
[0m16:05:20.081858 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/dchit/projects/open-ledger/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir .', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:05:20.082203 [info ] [MainThread]: dbt version: 1.7.19
[0m16:05:20.082470 [info ] [MainThread]: python version: 3.12.3
[0m16:05:20.082738 [info ] [MainThread]: python path: /home/dchit/projects/open-ledger/venv/bin/python3.12
[0m16:05:20.083058 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m16:05:20.084795 [info ] [MainThread]: Using profiles dir at .
[0m16:05:20.085124 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m16:05:20.085412 [info ] [MainThread]: Using dbt_project.yml file at /home/dchit/projects/open-ledger/dbt/dbt_project.yml
[0m16:05:20.140676 [info ] [MainThread]: Configuration:
[0m16:05:20.141303 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m16:05:20.141638 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:05:20.141916 [info ] [MainThread]: Required dependencies:
[0m16:05:20.142201 [debug] [MainThread]: Executing "git --help"
[0m16:05:20.144996 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:05:20.145547 [debug] [MainThread]: STDERR: "b''"
[0m16:05:20.145823 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:05:20.146071 [info ] [MainThread]: Connection test skipped since no profile was found
[0m16:05:20.146322 [info ] [MainThread]: [31m1 check failed:[0m
[0m16:05:20.146575 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  The profiles.yml file at ./profiles.yml is empty
  


[0m16:05:20.147374 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.07260801, "process_user_time": 1.08541, "process_kernel_time": 0.201001, "process_mem_max_rss": "99092", "process_out_blocks": "24", "command_success": false, "process_in_blocks": "0"}
[0m16:05:20.147751 [debug] [MainThread]: Command `dbt debug` failed at 16:05:20.147652 after 0.07 seconds
[0m16:05:20.148059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc2510c6ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc250ca1f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc250df6540>]}
[0m16:05:20.148380 [debug] [MainThread]: Flushing usage events
[0m16:05:33.348385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccb81cb0620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccb820c9130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccb81cb1040>]}


============================== 16:05:33.350300 | c853e982-1661-4e1f-bf1a-2e5534f4fbe5 ==============================
[0m16:05:33.350300 [info ] [MainThread]: Running with dbt=1.7.19
[0m16:05:33.350747 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/dchit/projects/open-ledger/dbt/logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir .', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:05:33.351098 [info ] [MainThread]: dbt version: 1.7.19
[0m16:05:33.351386 [info ] [MainThread]: python version: 3.12.3
[0m16:05:33.351655 [info ] [MainThread]: python path: /home/dchit/projects/open-ledger/venv/bin/python3.12
[0m16:05:33.351936 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m16:05:33.355253 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'SNOWFLAKE_ACCOUNT'
[0m16:05:33.355894 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.03264213, "process_user_time": 1.052238, "process_kernel_time": 0.104023, "process_mem_max_rss": "98272", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:05:33.356230 [debug] [MainThread]: Command `dbt debug` failed at 16:05:33.356132 after 0.03 seconds
[0m16:05:33.356467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccb81c97f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccb81cb0380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccb821a1070>]}
[0m16:05:33.356737 [debug] [MainThread]: Flushing usage events
[0m16:06:20.713537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a11449d0470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a11449d0680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a11449d03b0>]}


============================== 16:06:20.715747 | db664d7c-9e52-4621-8a92-2e0c0534c400 ==============================
[0m16:06:20.715747 [info ] [MainThread]: Running with dbt=1.7.19
[0m16:06:20.716172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/dchit/projects/open-ledger/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir .', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:06:20.716513 [info ] [MainThread]: dbt version: 1.7.19
[0m16:06:20.716823 [info ] [MainThread]: python version: 3.12.3
[0m16:06:20.717091 [info ] [MainThread]: python path: /home/dchit/projects/open-ledger/venv/bin/python3.12
[0m16:06:20.717366 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m16:06:20.720536 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'SNOWFLAKE_ACCOUNT'
[0m16:06:20.721424 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.035199247, "process_user_time": 1.106721, "process_kernel_time": 0.168414, "process_mem_max_rss": "98256", "process_in_blocks": "1016", "process_out_blocks": "8", "command_success": false}
[0m16:06:20.721833 [debug] [MainThread]: Command `dbt debug` failed at 16:06:20.721737 after 0.04 seconds
[0m16:06:20.722124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a11449d3e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1144f161b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1144dc2fc0>]}
[0m16:06:20.722441 [debug] [MainThread]: Flushing usage events
[0m16:07:43.949184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72970aec4200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72970bb04560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72970aec40b0>]}


============================== 16:07:43.951467 | 469ffea2-4ffc-444c-9386-e0faee146076 ==============================
[0m16:07:43.951467 [info ] [MainThread]: Running with dbt=1.7.19
[0m16:07:43.951859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/dchit/projects/open-ledger/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m16:07:43.952210 [info ] [MainThread]: dbt version: 1.7.19
[0m16:07:43.952500 [info ] [MainThread]: python version: 3.12.3
[0m16:07:43.952794 [info ] [MainThread]: python path: /home/dchit/projects/open-ledger/venv/bin/python3.12
[0m16:07:43.953055 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m16:07:44.408516 [info ] [MainThread]: Using profiles dir at .
[0m16:07:44.408946 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m16:07:44.409292 [info ] [MainThread]: Using dbt_project.yml file at /home/dchit/projects/open-ledger/dbt/dbt_project.yml
[0m16:07:44.409759 [info ] [MainThread]: adapter type: snowflake
[0m16:07:44.410024 [info ] [MainThread]: adapter version: 1.7.0
[0m16:07:44.461106 [info ] [MainThread]: Configuration:
[0m16:07:44.461589 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:07:44.461868 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:07:44.462135 [info ] [MainThread]: Required dependencies:
[0m16:07:44.462460 [debug] [MainThread]: Executing "git --help"
[0m16:07:44.464546 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:07:44.465049 [debug] [MainThread]: STDERR: "b''"
[0m16:07:44.465309 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:07:44.465630 [info ] [MainThread]: Connection:
[0m16:07:44.465908 [info ] [MainThread]:   account: VJAHCZT-VU00859
[0m16:07:44.466181 [info ] [MainThread]:   user: jdas
[0m16:07:44.466438 [info ] [MainThread]:   database: OPENLEDGER
[0m16:07:44.466718 [info ] [MainThread]:   warehouse: OPENLEDGER_WH
[0m16:07:44.466989 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m16:07:44.467266 [info ] [MainThread]:   schema: ANALYTICS
[0m16:07:44.467522 [info ] [MainThread]:   authenticator: None
[0m16:07:44.467792 [info ] [MainThread]:   private_key_path: None
[0m16:07:44.468066 [info ] [MainThread]:   token: None
[0m16:07:44.468341 [info ] [MainThread]:   oauth_client_id: None
[0m16:07:44.468633 [info ] [MainThread]:   query_tag: None
[0m16:07:44.468931 [info ] [MainThread]:   client_session_keep_alive: False
[0m16:07:44.469226 [info ] [MainThread]:   host: None
[0m16:07:44.469683 [info ] [MainThread]:   port: None
[0m16:07:44.470020 [info ] [MainThread]:   proxy_host: None
[0m16:07:44.470304 [info ] [MainThread]:   proxy_port: None
[0m16:07:44.470585 [info ] [MainThread]:   protocol: None
[0m16:07:44.470867 [info ] [MainThread]:   connect_retries: 1
[0m16:07:44.471211 [info ] [MainThread]:   connect_timeout: None
[0m16:07:44.471551 [info ] [MainThread]:   retry_on_database_errors: False
[0m16:07:44.471838 [info ] [MainThread]:   retry_all: False
[0m16:07:44.472127 [info ] [MainThread]:   insecure_mode: False
[0m16:07:44.472389 [info ] [MainThread]:   reuse_connections: None
[0m16:07:44.472709 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m16:07:44.473237 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m16:07:44.473831 [debug] [MainThread]: Using snowflake connection "debug"
[0m16:07:44.474118 [debug] [MainThread]: On debug: select 1 as id
[0m16:07:44.474356 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:07:47.700803 [debug] [MainThread]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:07:47.701704 [debug] [MainThread]: On debug: Close
[0m16:07:47.786641 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:07:47.787060 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:07:47.787773 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.8657277, "process_user_time": 1.784193, "process_kernel_time": 1.417796, "process_mem_max_rss": "184704", "process_in_blocks": "264", "process_out_blocks": "40"}
[0m16:07:47.788093 [debug] [MainThread]: Command `dbt debug` succeeded at 16:07:47.788006 after 3.87 seconds
[0m16:07:47.788325 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:07:47.788571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7296e049a1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72970bb04560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7296dfda9f10>]}
[0m16:07:47.788839 [debug] [MainThread]: Flushing usage events
[0m16:11:10.810358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d22f4c5ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d22f4c5ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d22f4c7b30>]}


============================== 16:11:10.812549 | 91d87bdf-3b2f-4007-8d7c-d787a27f427e ==============================
[0m16:11:10.812549 [info ] [MainThread]: Running with dbt=1.7.19
[0m16:11:10.812944 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/dchit/projects/open-ledger/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/dchit/projects/open-ledger/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:11:11.311414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91d87bdf-3b2f-4007-8d7c-d787a27f427e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d22b73bb00>]}
[0m16:11:11.343957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91d87bdf-3b2f-4007-8d7c-d787a27f427e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d22f79f4d0>]}
[0m16:11:11.344570 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m16:11:11.348734 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m16:11:11.349235 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:11:11.349546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '91d87bdf-3b2f-4007-8d7c-d787a27f427e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d203002180>]}
[0m16:11:11.749452 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.openledger.example
[0m16:11:11.752492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91d87bdf-3b2f-4007-8d7c-d787a27f427e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d202ddc830>]}
[0m16:11:11.758279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91d87bdf-3b2f-4007-8d7c-d787a27f427e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d202e289b0>]}
[0m16:11:11.758678 [info ] [MainThread]: Found 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:11:11.758962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91d87bdf-3b2f-4007-8d7c-d787a27f427e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d202fab7d0>]}
[0m16:11:11.760030 [info ] [MainThread]: 
[0m16:11:11.760350 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:11:11.760720 [debug] [MainThread]: Command end result
[0m16:11:11.769873 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.9855192, "process_user_time": 1.973462, "process_kernel_time": 1.369014, "process_mem_max_rss": "172928", "process_in_blocks": "248", "process_out_blocks": "2528"}
[0m16:11:11.770709 [debug] [MainThread]: Command `dbt compile` succeeded at 16:11:11.770564 after 0.99 seconds
[0m16:11:11.771216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d22f94ddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d22f8dacc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d2030467e0>]}
[0m16:11:11.771534 [debug] [MainThread]: Flushing usage events
[0m16:13:44.821716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3a2c9400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3a812ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3b091a30>]}


============================== 16:13:44.825663 | cf46c8f2-d0d5-4de3-80f7-4c2a8906c96d ==============================
[0m16:13:44.825663 [info ] [MainThread]: Running with dbt=1.7.19
[0m16:13:44.826240 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/dchit/projects/open-ledger/dbt/logs', 'profiles_dir': '/home/dchit/projects/open-ledger/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:13:45.778016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf46c8f2-d0d5-4de3-80f7-4c2a8906c96d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0df96690>]}
[0m16:13:45.815263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf46c8f2-d0d5-4de3-80f7-4c2a8906c96d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0ddd0740>]}
[0m16:13:45.816919 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m16:13:45.823160 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m16:13:45.831577 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:13:45.831962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cf46c8f2-d0d5-4de3-80f7-4c2a8906c96d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3a5bdc10>]}
[0m16:13:46.457104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf46c8f2-d0d5-4de3-80f7-4c2a8906c96d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0dac3140>]}
[0m16:13:46.464631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf46c8f2-d0d5-4de3-80f7-4c2a8906c96d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0dd16d20>]}
[0m16:13:46.465111 [info ] [MainThread]: Found 1 model, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:13:46.465457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf46c8f2-d0d5-4de3-80f7-4c2a8906c96d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0dbf7c80>]}
[0m16:13:46.466966 [info ] [MainThread]: 
[0m16:13:46.467763 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:13:46.469764 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_OPENLEDGER'
[0m16:13:46.480485 [debug] [ThreadPool]: Using snowflake connection "list_OPENLEDGER"
[0m16:13:46.480893 [debug] [ThreadPool]: On list_OPENLEDGER: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "openledger", "target_name": "dev", "connection_name": "list_OPENLEDGER"} */
show terse schemas in database OPENLEDGER
    limit 10000
[0m16:13:46.481223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:49.807304 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.0 seconds
[0m16:13:49.808733 [debug] [ThreadPool]: On list_OPENLEDGER: Close
[0m16:13:49.900227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_OPENLEDGER, now create_OPENLEDGER_ANALYTICS)
[0m16:13:49.900881 [debug] [ThreadPool]: Creating schema "database: "OPENLEDGER"
schema: "ANALYTICS"
"
[0m16:13:49.904061 [debug] [ThreadPool]: Using snowflake connection "create_OPENLEDGER_ANALYTICS"
[0m16:13:49.904333 [debug] [ThreadPool]: On create_OPENLEDGER_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "openledger", "target_name": "dev", "connection_name": "create_OPENLEDGER_ANALYTICS"} */
create schema if not exists OPENLEDGER.ANALYTICS
[0m16:13:49.904585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:13:52.276813 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:13:52.278142 [debug] [ThreadPool]: On create_OPENLEDGER_ANALYTICS: Close
[0m16:13:52.369914 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_OPENLEDGER_ANALYTICS, now list_OPENLEDGER_ANALYTICS)
[0m16:13:52.375326 [debug] [ThreadPool]: Using snowflake connection "list_OPENLEDGER_ANALYTICS"
[0m16:13:52.375647 [debug] [ThreadPool]: On list_OPENLEDGER_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "openledger", "target_name": "dev", "connection_name": "list_OPENLEDGER_ANALYTICS"} */
show terse objects in OPENLEDGER.ANALYTICS limit 10000
[0m16:13:52.375879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:13:55.449369 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 3.0 seconds
[0m16:13:55.450670 [debug] [ThreadPool]: On list_OPENLEDGER_ANALYTICS: Close
[0m16:13:55.541935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf46c8f2-d0d5-4de3-80f7-4c2a8906c96d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0dae9c70>]}
[0m16:13:55.542999 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:13:55.543342 [info ] [MainThread]: 
[0m16:13:55.545923 [debug] [Thread-1 (]: Began running node model.openledger.staging_transactions
[0m16:13:55.546531 [info ] [Thread-1 (]: 1 of 1 START sql view model ANALYTICS.staging_transactions ..................... [RUN]
[0m16:13:55.547011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_OPENLEDGER_ANALYTICS, now model.openledger.staging_transactions)
[0m16:13:55.547281 [debug] [Thread-1 (]: Began compiling node model.openledger.staging_transactions
[0m16:13:55.551675 [debug] [Thread-1 (]: Writing injected SQL for node "model.openledger.staging_transactions"
[0m16:13:55.555115 [debug] [Thread-1 (]: Timing info for model.openledger.staging_transactions (compile): 16:13:55.547461 => 16:13:55.554878
[0m16:13:55.555501 [debug] [Thread-1 (]: Began executing node model.openledger.staging_transactions
[0m16:13:55.580252 [debug] [Thread-1 (]: Writing runtime sql for node "model.openledger.staging_transactions"
[0m16:13:55.583615 [debug] [Thread-1 (]: Using snowflake connection "model.openledger.staging_transactions"
[0m16:13:55.584004 [debug] [Thread-1 (]: On model.openledger.staging_transactions: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "openledger", "target_name": "dev", "node_id": "model.openledger.staging_transactions"} */
create or replace   view OPENLEDGER.ANALYTICS.staging_transactions
  
   as (
    

WITH source AS (
    SELECT * FROM OPENLEDGER.RAW.transactions
),

cleaned AS (
    SELECT
        -- IDs
        TRIM(transaction_id) AS transaction_id,
        TRIM(user_id) AS user_id,
        TRIM(merchant_id) AS merchant_id,

        -- Numeric Conversion (Handle empty strings safely)
        TRY_CAST(amount AS NUMBER(18, 2)) AS amount,
        TRIM(currency) AS currency,

        -- Status & Type
        LOWER(TRIM(transaction_type)) AS transaction_type,
        LOWER(TRIM(status)) AS status,

        -- Timestamp Conversion
        TRY_TO_TIMESTAMP(event_time) AS event_time

    FROM source
)

SELECT * FROM cleaned
  );
[0m16:13:55.584290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:13:58.074546 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:13:58.086315 [debug] [Thread-1 (]: Timing info for model.openledger.staging_transactions (execute): 16:13:55.555723 => 16:13:58.086161
[0m16:13:58.086637 [debug] [Thread-1 (]: On model.openledger.staging_transactions: Close
[0m16:13:58.190121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf46c8f2-d0d5-4de3-80f7-4c2a8906c96d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b04ef8b30>]}
[0m16:13:58.190759 [info ] [Thread-1 (]: 1 of 1 OK created sql view model ANALYTICS.staging_transactions ................ [[32mSUCCESS 1[0m in 2.64s]
[0m16:13:58.191222 [debug] [Thread-1 (]: Finished running node model.openledger.staging_transactions
[0m16:13:58.193501 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:13:58.193974 [debug] [MainThread]: Connection 'model.openledger.staging_transactions' was properly closed.
[0m16:13:58.194420 [info ] [MainThread]: 
[0m16:13:58.194754 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 11.73 seconds (11.73s).
[0m16:13:58.195210 [debug] [MainThread]: Command end result
[0m16:13:58.200333 [info ] [MainThread]: 
[0m16:13:58.200762 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:13:58.201103 [info ] [MainThread]: 
[0m16:13:58.201475 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:13:58.202307 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.418089, "process_user_time": 2.586652, "process_kernel_time": 1.703308, "process_mem_max_rss": "193288", "process_in_blocks": "117632", "process_out_blocks": "2600"}
[0m16:13:58.202683 [debug] [MainThread]: Command `dbt run` succeeded at 16:13:58.202591 after 13.42 seconds
[0m16:13:58.202994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3a5bda30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0dcb3410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0dbd61b0>]}
[0m16:13:58.203371 [debug] [MainThread]: Flushing usage events
[0m16:17:50.340352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7924b71dd490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7924b71de540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7924b71dc080>]}


============================== 16:17:50.343350 | df804b28-3dad-41cc-82cf-c86c2f4327f2 ==============================
[0m16:17:50.343350 [info ] [MainThread]: Running with dbt=1.7.19
[0m16:17:50.343747 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/dchit/projects/open-ledger/dbt', 'log_path': '/home/dchit/projects/open-ledger/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:17:51.336107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df804b28-3dad-41cc-82cf-c86c2f4327f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7924b75ee870>]}
[0m16:17:51.375939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df804b28-3dad-41cc-82cf-c86c2f4327f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7924b749e4e0>]}
[0m16:17:51.377291 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m16:17:51.383647 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m16:17:51.446510 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m16:17:51.447276 [debug] [MainThread]: Partial parsing: added file: openledger://models/staging/staging_entries.sql
[0m16:17:51.447559 [debug] [MainThread]: Partial parsing: added file: openledger://models/staging/staging_settlements.sql
[0m16:17:51.447883 [debug] [MainThread]: Partial parsing: updated file: openledger://models/staging/staging_transactions.sql
[0m16:17:51.537690 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.openledger.staging_entries' (models/staging/staging_entries.sql) depends on a source named 'openledger.entries' which was not found
[0m16:17:51.539704 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2303083, "process_user_time": 1.988516, "process_kernel_time": 1.533412, "process_mem_max_rss": "171760", "process_in_blocks": "155984", "process_out_blocks": "16", "command_success": false}
[0m16:17:51.540539 [debug] [MainThread]: Command `dbt run` failed at 16:17:51.540348 after 1.23 seconds
[0m16:17:51.540876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7924b76c5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79248af44770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79248ab95d90>]}
[0m16:17:51.541216 [debug] [MainThread]: Flushing usage events
[0m16:18:07.176654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e2f781640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e2f783ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e2f7835c0>]}


============================== 16:18:07.179204 | 12587e84-603e-4aa2-9aa1-a5dbb1a576b0 ==============================
[0m16:18:07.179204 [info ] [MainThread]: Running with dbt=1.7.19
[0m16:18:07.179624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/dchit/projects/open-ledger/dbt/logs', 'profiles_dir': '/home/dchit/projects/open-ledger/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:18:07.660605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12587e84-603e-4aa2-9aa1-a5dbb1a576b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e03ae0fe0>]}
[0m16:18:07.693172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12587e84-603e-4aa2-9aa1-a5dbb1a576b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e05541df0>]}
[0m16:18:07.693867 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m16:18:07.700619 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m16:18:07.718080 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m16:18:07.718837 [debug] [MainThread]: Partial parsing: added file: openledger://models/staging/staging_settlements.sql
[0m16:18:07.719115 [debug] [MainThread]: Partial parsing: added file: openledger://models/staging/staging_entries.sql
[0m16:18:07.719424 [debug] [MainThread]: Partial parsing: updated file: openledger://models/staging/staging_transactions.sql
[0m16:18:07.817444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12587e84-603e-4aa2-9aa1-a5dbb1a576b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e032a44d0>]}
[0m16:18:07.823864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12587e84-603e-4aa2-9aa1-a5dbb1a576b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e0316b2c0>]}
[0m16:18:07.824258 [info ] [MainThread]: Found 3 models, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:18:07.824563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12587e84-603e-4aa2-9aa1-a5dbb1a576b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e2e987740>]}
[0m16:18:07.825853 [info ] [MainThread]: 
[0m16:18:07.826432 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:18:07.827592 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_OPENLEDGER'
[0m16:18:07.836162 [debug] [ThreadPool]: Using snowflake connection "list_OPENLEDGER"
[0m16:18:07.836515 [debug] [ThreadPool]: On list_OPENLEDGER: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "openledger", "target_name": "dev", "connection_name": "list_OPENLEDGER"} */
show terse schemas in database OPENLEDGER
    limit 10000
[0m16:18:07.836750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:11.291597 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m16:18:11.292787 [debug] [ThreadPool]: On list_OPENLEDGER: Close
[0m16:18:11.396847 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_OPENLEDGER, now list_OPENLEDGER_ANALYTICS)
[0m16:18:11.401981 [debug] [ThreadPool]: Using snowflake connection "list_OPENLEDGER_ANALYTICS"
[0m16:18:11.402244 [debug] [ThreadPool]: On list_OPENLEDGER_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "openledger", "target_name": "dev", "connection_name": "list_OPENLEDGER_ANALYTICS"} */
show terse objects in OPENLEDGER.ANALYTICS limit 10000
[0m16:18:11.402464 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:18:13.774323 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:18:13.775703 [debug] [ThreadPool]: On list_OPENLEDGER_ANALYTICS: Close
[0m16:18:13.876894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12587e84-603e-4aa2-9aa1-a5dbb1a576b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e2fed6060>]}
[0m16:18:13.877884 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:18:13.878180 [info ] [MainThread]: 
[0m16:18:13.880936 [debug] [Thread-1 (]: Began running node model.openledger.staging_entries
[0m16:18:13.881362 [debug] [Thread-2 (]: Began running node model.openledger.staging_settlements
[0m16:18:13.881769 [debug] [Thread-3 (]: Began running node model.openledger.staging_transactions
[0m16:18:13.882399 [info ] [Thread-1 (]: 1 of 3 START sql view model ANALYTICS.staging_entries .......................... [RUN]
[0m16:18:13.883048 [info ] [Thread-2 (]: 2 of 3 START sql view model ANALYTICS.staging_settlements ...................... [RUN]
[0m16:18:13.883595 [info ] [Thread-3 (]: 3 of 3 START sql view model ANALYTICS.staging_transactions ..................... [RUN]
[0m16:18:13.884289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_OPENLEDGER_ANALYTICS, now model.openledger.staging_entries)
[0m16:18:13.885038 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.openledger.staging_settlements'
[0m16:18:13.885631 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.openledger.staging_transactions'
[0m16:18:13.886133 [debug] [Thread-1 (]: Began compiling node model.openledger.staging_entries
[0m16:18:13.886680 [debug] [Thread-2 (]: Began compiling node model.openledger.staging_settlements
[0m16:18:13.886990 [debug] [Thread-3 (]: Began compiling node model.openledger.staging_transactions
[0m16:18:13.897206 [debug] [Thread-1 (]: Writing injected SQL for node "model.openledger.staging_entries"
[0m16:18:13.900393 [debug] [Thread-2 (]: Writing injected SQL for node "model.openledger.staging_settlements"
[0m16:18:13.902884 [debug] [Thread-3 (]: Writing injected SQL for node "model.openledger.staging_transactions"
[0m16:18:13.904112 [debug] [Thread-1 (]: Timing info for model.openledger.staging_entries (compile): 16:18:13.887331 => 16:18:13.903923
[0m16:18:13.904459 [debug] [Thread-2 (]: Timing info for model.openledger.staging_settlements (compile): 16:18:13.898055 => 16:18:13.904317
[0m16:18:13.904812 [debug] [Thread-1 (]: Began executing node model.openledger.staging_entries
[0m16:18:13.905158 [debug] [Thread-2 (]: Began executing node model.openledger.staging_settlements
[0m16:18:13.905779 [debug] [Thread-3 (]: Timing info for model.openledger.staging_transactions (compile): 16:18:13.900804 => 16:18:13.905496
[0m16:18:13.927453 [debug] [Thread-1 (]: Writing runtime sql for node "model.openledger.staging_entries"
[0m16:18:13.930150 [debug] [Thread-2 (]: Writing runtime sql for node "model.openledger.staging_settlements"
[0m16:18:13.930721 [debug] [Thread-3 (]: Began executing node model.openledger.staging_transactions
[0m16:18:13.932251 [debug] [Thread-1 (]: Using snowflake connection "model.openledger.staging_entries"
[0m16:18:13.933367 [debug] [Thread-2 (]: Using snowflake connection "model.openledger.staging_settlements"
[0m16:18:13.936857 [debug] [Thread-3 (]: Writing runtime sql for node "model.openledger.staging_transactions"
[0m16:18:13.937677 [debug] [Thread-1 (]: On model.openledger.staging_entries: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "openledger", "target_name": "dev", "node_id": "model.openledger.staging_entries"} */
create or replace   view OPENLEDGER.ANALYTICS.staging_entries
  
   as (
    

WITH source AS (
    SELECT * FROM OPENLEDGER.RAW.ledger_entries
),

cleaned AS (
    SELECT
        TRIM(entry_id) AS entry_id,
        TRIM(transaction_id) AS transaction_id,
        TRIM(account_id) AS account_id,
        
        -- Standardize types
        LOWER(TRIM(account_type)) AS account_type,
        LOWER(TRIM(entry_type)) AS entry_type,
        
        -- Safe conversions
        TRY_CAST(amount AS NUMBER(18, 2)) AS amount,
        TRY_TO_TIMESTAMP(event_time) AS event_time

    FROM source
)

SELECT * FROM cleaned
  );
[0m16:18:13.938201 [debug] [Thread-2 (]: On model.openledger.staging_settlements: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "openledger", "target_name": "dev", "node_id": "model.openledger.staging_settlements"} */
create or replace   view OPENLEDGER.ANALYTICS.staging_settlements
  
   as (
    

WITH source AS (
    SELECT * FROM OPENLEDGER.RAW.settlements
),

cleaned AS (
    SELECT
        TRIM(settlement_id) AS settlement_id,
        TRIM(transaction_id) AS transaction_id,
        TRIM(merchant_id) AS merchant_id,

        -- Financials
        TRY_CAST(gross_amount AS NUMBER(18, 2)) AS gross_amount,
        TRY_CAST(fee_amount AS NUMBER(18, 2)) AS fee_amount,
        TRY_CAST(net_amount AS NUMBER(18, 2)) AS net_amount,
        TRIM(currency) AS currency,

        -- Dates & Status
        TRY_TO_DATE(settlement_date) AS settlement_date,
        TRIM(processor_reference) AS processor_reference,
        LOWER(TRIM(status)) AS status,
        TRIM(discrepancy_reason) AS discrepancy_reason

    FROM source
)

SELECT * FROM cleaned
  );
[0m16:18:13.938816 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:18:13.939376 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:18:13.941322 [debug] [Thread-3 (]: Using snowflake connection "model.openledger.staging_transactions"
[0m16:18:13.957560 [debug] [Thread-3 (]: On model.openledger.staging_transactions: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "openledger", "target_name": "dev", "node_id": "model.openledger.staging_transactions"} */
create or replace   view OPENLEDGER.ANALYTICS.staging_transactions
  
   as (
    

WITH source AS (
    SELECT * FROM OPENLEDGER.RAW.transactions
),

cleaned AS (
    SELECT
        -- IDs
        TRIM(transaction_id) AS transaction_id,
        TRIM(user_id) AS user_id,
        TRIM(merchant_id) AS merchant_id,

        -- Numeric Conversion (Handle empty strings safely)
        TRY_CAST(amount AS NUMBER(18, 2)) AS amount,
        TRIM(currency) AS currency,

        -- Status & Type
        LOWER(TRIM(transaction_type)) AS transaction_type,
        LOWER(TRIM(status)) AS status,

        -- Timestamp Conversion
        TRY_TO_TIMESTAMP(event_time) AS event_time

    FROM source
)

SELECT * FROM cleaned
  );
[0m16:18:13.960395 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:18:16.523273 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:18:16.534371 [debug] [Thread-2 (]: Timing info for model.openledger.staging_settlements (execute): 16:18:13.927810 => 16:18:16.534214
[0m16:18:16.534677 [debug] [Thread-2 (]: On model.openledger.staging_settlements: Close
[0m16:18:16.658463 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12587e84-603e-4aa2-9aa1-a5dbb1a576b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e00564a40>]}
[0m16:18:16.659045 [info ] [Thread-2 (]: 2 of 3 OK created sql view model ANALYTICS.staging_settlements ................. [[32mSUCCESS 1[0m in 2.77s]
[0m16:18:16.659519 [debug] [Thread-2 (]: Finished running node model.openledger.staging_settlements
[0m16:18:17.126333 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:18:17.128053 [debug] [Thread-1 (]: Timing info for model.openledger.staging_entries (execute): 16:18:13.906149 => 16:18:17.127931
[0m16:18:17.128307 [debug] [Thread-1 (]: On model.openledger.staging_entries: Close
[0m16:18:17.214576 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:18:17.219749 [debug] [Thread-3 (]: Timing info for model.openledger.staging_transactions (execute): 16:18:13.933974 => 16:18:17.219579
[0m16:18:17.220097 [debug] [Thread-3 (]: On model.openledger.staging_transactions: Close
[0m16:18:17.224384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12587e84-603e-4aa2-9aa1-a5dbb1a576b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e00565130>]}
[0m16:18:17.225115 [info ] [Thread-1 (]: 1 of 3 OK created sql view model ANALYTICS.staging_entries ..................... [[32mSUCCESS 1[0m in 3.34s]
[0m16:18:17.225709 [debug] [Thread-1 (]: Finished running node model.openledger.staging_entries
[0m16:18:17.335403 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12587e84-603e-4aa2-9aa1-a5dbb1a576b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3dfaebf950>]}
[0m16:18:17.336455 [info ] [Thread-3 (]: 3 of 3 OK created sql view model ANALYTICS.staging_transactions ................ [[32mSUCCESS 1[0m in 3.45s]
[0m16:18:17.336958 [debug] [Thread-3 (]: Finished running node model.openledger.staging_transactions
[0m16:18:17.340456 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:18:17.341125 [debug] [MainThread]: Connection 'model.openledger.staging_entries' was properly closed.
[0m16:18:17.341674 [debug] [MainThread]: Connection 'model.openledger.staging_settlements' was properly closed.
[0m16:18:17.342064 [debug] [MainThread]: Connection 'model.openledger.staging_transactions' was properly closed.
[0m16:18:17.342555 [info ] [MainThread]: 
[0m16:18:17.342981 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 9.52 seconds (9.52s).
[0m16:18:17.343853 [debug] [MainThread]: Command end result
[0m16:18:17.450484 [info ] [MainThread]: 
[0m16:18:17.450945 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:18:17.451268 [info ] [MainThread]: 
[0m16:18:17.451589 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:18:17.452341 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.302453, "process_user_time": 2.231873, "process_kernel_time": 1.52283, "process_mem_max_rss": "197384", "process_in_blocks": "13360", "process_out_blocks": "2672"}
[0m16:18:17.452694 [debug] [MainThread]: Command `dbt run` succeeded at 16:18:17.452597 after 10.30 seconds
[0m16:18:17.452976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e2fed6060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e0392acc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e02f89610>]}
[0m16:18:17.453250 [debug] [MainThread]: Flushing usage events
[0m17:04:01.773135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6f0f9b82c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6f0fd59cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6f0f9b84a0>]}


============================== 17:04:01.776604 | 79652d53-c3a8-4295-a623-dabd6515dd14 ==============================
[0m17:04:01.776604 [info ] [MainThread]: Running with dbt=1.7.19
[0m17:04:01.777173 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/dchit/projects/open-ledger/dbt/logs', 'debug': 'False', 'profiles_dir': '/home/dchit/projects/open-ledger/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:04:02.859953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79652d53-c3a8-4295-a623-dabd6515dd14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6ee3746d50>]}
[0m17:04:02.901163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79652d53-c3a8-4295-a623-dabd6515dd14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6f10ccc5f0>]}
[0m17:04:02.903020 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m17:04:02.909684 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m17:04:02.963524 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:04:02.964353 [debug] [MainThread]: Partial parsing: added file: openledger://models/staging/schema.yml
[0m17:04:03.097984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79652d53-c3a8-4295-a623-dabd6515dd14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6ee32c2ed0>]}
[0m17:04:03.107414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79652d53-c3a8-4295-a623-dabd6515dd14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6ee335daf0>]}
[0m17:04:03.107959 [info ] [MainThread]: Found 3 models, 8 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m17:04:03.108270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79652d53-c3a8-4295-a623-dabd6515dd14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6ee32b72f0>]}
[0m17:04:03.109865 [info ] [MainThread]: 
[0m17:04:03.110542 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:04:03.111949 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_OPENLEDGER_ANALYTICS'
[0m17:04:03.124252 [debug] [ThreadPool]: Using snowflake connection "list_OPENLEDGER_ANALYTICS"
[0m17:04:03.124864 [debug] [ThreadPool]: On list_OPENLEDGER_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "openledger", "target_name": "dev", "connection_name": "list_OPENLEDGER_ANALYTICS"} */
show terse objects in OPENLEDGER.ANALYTICS limit 10000
[0m17:04:03.125129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:06.566020 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.0 seconds
[0m17:04:06.567592 [debug] [ThreadPool]: On list_OPENLEDGER_ANALYTICS: Close
[0m17:04:06.661581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79652d53-c3a8-4295-a623-dabd6515dd14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6ee3607860>]}
[0m17:04:06.662782 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:04:06.663420 [info ] [MainThread]: 
[0m17:04:06.667658 [debug] [Thread-1 (]: Began running node test.openledger.accepted_values_staging_transactions_status__completed__failed__pending__declined.36daace0a3
[0m17:04:06.669871 [debug] [Thread-2 (]: Began running node test.openledger.not_null_staging_settlements_settlement_id.1b418a3038
[0m17:04:06.670878 [debug] [Thread-3 (]: Began running node test.openledger.not_null_staging_transactions_amount.39c556e413
[0m17:04:06.670502 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_staging_transactions_status__completed__failed__pending__declined  [RUN]
[0m17:04:06.671392 [debug] [Thread-4 (]: Began running node test.openledger.not_null_staging_transactions_transaction_id.d4f9e42898
[0m17:04:06.671844 [info ] [Thread-2 (]: 2 of 8 START test not_null_staging_settlements_settlement_id ................... [RUN]
[0m17:04:06.672488 [info ] [Thread-3 (]: 3 of 8 START test not_null_staging_transactions_amount ......................... [RUN]
[0m17:04:06.674148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_OPENLEDGER_ANALYTICS, now test.openledger.accepted_values_staging_transactions_status__completed__failed__pending__declined.36daace0a3)
[0m17:04:06.674854 [info ] [Thread-4 (]: 4 of 8 START test not_null_staging_transactions_transaction_id ................. [RUN]
[0m17:04:06.676034 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.openledger.not_null_staging_settlements_settlement_id.1b418a3038'
[0m17:04:06.677009 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.openledger.not_null_staging_transactions_amount.39c556e413'
[0m17:04:06.677732 [debug] [Thread-1 (]: Began compiling node test.openledger.accepted_values_staging_transactions_status__completed__failed__pending__declined.36daace0a3
[0m17:04:06.678885 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.openledger.not_null_staging_transactions_transaction_id.d4f9e42898'
[0m17:04:06.679575 [debug] [Thread-2 (]: Began compiling node test.openledger.not_null_staging_settlements_settlement_id.1b418a3038
[0m17:04:06.680083 [debug] [Thread-3 (]: Began compiling node test.openledger.not_null_staging_transactions_amount.39c556e413
[0m17:04:06.691570 [debug] [Thread-1 (]: Writing injected SQL for node "test.openledger.accepted_values_staging_transactions_status__completed__failed__pending__declined.36daace0a3"
[0m17:04:06.692224 [debug] [Thread-4 (]: Began compiling node test.openledger.not_null_staging_transactions_transaction_id.d4f9e42898
[0m17:04:06.698804 [debug] [Thread-2 (]: Writing injected SQL for node "test.openledger.not_null_staging_settlements_settlement_id.1b418a3038"
[0m17:04:06.702670 [debug] [Thread-3 (]: Writing injected SQL for node "test.openledger.not_null_staging_transactions_amount.39c556e413"
[0m17:04:06.705649 [debug] [Thread-4 (]: Writing injected SQL for node "test.openledger.not_null_staging_transactions_transaction_id.d4f9e42898"
[0m17:04:06.707058 [debug] [Thread-2 (]: Timing info for test.openledger.not_null_staging_settlements_settlement_id.1b418a3038 (compile): 17:04:06.692716 => 17:04:06.706867
[0m17:04:06.707551 [debug] [Thread-2 (]: Began executing node test.openledger.not_null_staging_settlements_settlement_id.1b418a3038
[0m17:04:06.708459 [debug] [Thread-1 (]: Timing info for test.openledger.accepted_values_staging_transactions_status__completed__failed__pending__declined.36daace0a3 (compile): 17:04:06.680424 => 17:04:06.708154
[0m17:04:06.708889 [debug] [Thread-3 (]: Timing info for test.openledger.not_null_staging_transactions_amount.39c556e413 (compile): 17:04:06.699392 => 17:04:06.708740
[0m17:04:06.709499 [debug] [Thread-4 (]: Timing info for test.openledger.not_null_staging_transactions_transaction_id.d4f9e42898 (compile): 17:04:06.703246 => 17:04:06.709118
[0m17:04:06.723359 [debug] [Thread-2 (]: Writing runtime sql for node "test.openledger.not_null_staging_settlements_settlement_id.1b418a3038"
[0m17:04:06.724194 [debug] [Thread-1 (]: Began executing node test.openledger.accepted_values_staging_transactions_status__completed__failed__pending__declined.36daace0a3
[0m17:04:06.724718 [debug] [Thread-3 (]: Began executing node test.openledger.not_null_staging_transactions_amount.39c556e413
[0m17:04:06.725169 [debug] [Thread-4 (]: Began executing node test.openledger.not_null_staging_transactions_transaction_id.d4f9e42898
[0m17:04:06.728587 [debug] [Thread-1 (]: Writing runtime sql for node "test.openledger.accepted_values_staging_transactions_status__completed__failed__pending__declined.36daace0a3"
[0m17:04:06.731001 [debug] [Thread-3 (]: Writing runtime sql for node "test.openledger.not_null_staging_transactions_amount.39c556e413"
[0m17:04:06.732616 [debug] [Thread-4 (]: Writing runtime sql for node "test.openledger.not_null_staging_transactions_transaction_id.d4f9e42898"
[0m17:04:06.733638 [debug] [Thread-2 (]: Using snowflake connection "test.openledger.not_null_staging_settlements_settlement_id.1b418a3038"
[0m17:04:06.734885 [debug] [Thread-1 (]: Using snowflake connection "test.openledger.accepted_values_staging_transactions_status__completed__failed__pending__declined.36daace0a3"
[0m17:04:06.735407 [debug] [Thread-2 (]: On test.openledger.not_null_staging_settlements_settlement_id.1b418a3038: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "openledger", "target_name": "dev", "node_id": "test.openledger.not_null_staging_settlements_settlement_id.1b418a3038"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select settlement_id
from OPENLEDGER.ANALYTICS.staging_settlements
where settlement_id is null



      
    ) dbt_internal_test
[0m17:04:06.735987 [debug] [Thread-4 (]: Using snowflake connection "test.openledger.not_null_staging_transactions_transaction_id.d4f9e42898"
[0m17:04:06.736541 [debug] [Thread-3 (]: Using snowflake connection "test.openledger.not_null_staging_transactions_amount.39c556e413"
[0m17:04:06.736972 [debug] [Thread-1 (]: On test.openledger.accepted_values_staging_transactions_status__completed__failed__pending__declined.36daace0a3: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "openledger", "target_name": "dev", "node_id": "test.openledger.accepted_values_staging_transactions_status__completed__failed__pending__declined.36daace0a3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from OPENLEDGER.ANALYTICS.staging_transactions
    group by status

)

select *
from all_values
where value_field not in (
    'completed','failed','pending','declined'
)



      
    ) dbt_internal_test
[0m17:04:06.737533 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:04:06.738088 [debug] [Thread-4 (]: On test.openledger.not_null_staging_transactions_transaction_id.d4f9e42898: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "openledger", "target_name": "dev", "node_id": "test.openledger.not_null_staging_transactions_transaction_id.d4f9e42898"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select transaction_id
from OPENLEDGER.ANALYTICS.staging_transactions
where transaction_id is null



      
    ) dbt_internal_test
[0m17:04:06.738726 [debug] [Thread-3 (]: On test.openledger.not_null_staging_transactions_amount.39c556e413: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "openledger", "target_name": "dev", "node_id": "test.openledger.not_null_staging_transactions_amount.39c556e413"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select amount
from OPENLEDGER.ANALYTICS.staging_transactions
where amount is null



      
    ) dbt_internal_test
[0m17:04:06.739391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:04:06.744540 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:04:06.745376 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:04:09.802872 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m17:04:09.807654 [debug] [Thread-4 (]: Timing info for test.openledger.not_null_staging_transactions_transaction_id.d4f9e42898 (execute): 17:04:06.731306 => 17:04:09.807399
[0m17:04:09.807959 [debug] [Thread-4 (]: On test.openledger.not_null_staging_transactions_transaction_id.d4f9e42898: Close
[0m17:04:09.910761 [info ] [Thread-4 (]: 4 of 8 PASS not_null_staging_transactions_transaction_id ....................... [[32mPASS[0m in 3.23s]
[0m17:04:09.911436 [debug] [Thread-4 (]: Finished running node test.openledger.not_null_staging_transactions_transaction_id.d4f9e42898
[0m17:04:09.911829 [debug] [Thread-4 (]: Began running node test.openledger.not_null_staging_transactions_user_id.6e7b530ec6
[0m17:04:09.912275 [info ] [Thread-4 (]: 5 of 8 START test not_null_staging_transactions_user_id ........................ [RUN]
[0m17:04:09.912848 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.openledger.not_null_staging_transactions_transaction_id.d4f9e42898, now test.openledger.not_null_staging_transactions_user_id.6e7b530ec6)
[0m17:04:09.913154 [debug] [Thread-4 (]: Began compiling node test.openledger.not_null_staging_transactions_user_id.6e7b530ec6
[0m17:04:09.916156 [debug] [Thread-4 (]: Writing injected SQL for node "test.openledger.not_null_staging_transactions_user_id.6e7b530ec6"
[0m17:04:09.916667 [debug] [Thread-4 (]: Timing info for test.openledger.not_null_staging_transactions_user_id.6e7b530ec6 (compile): 17:04:09.913343 => 17:04:09.916529
[0m17:04:09.916901 [debug] [Thread-4 (]: Began executing node test.openledger.not_null_staging_transactions_user_id.6e7b530ec6
[0m17:04:09.918413 [debug] [Thread-4 (]: Writing runtime sql for node "test.openledger.not_null_staging_transactions_user_id.6e7b530ec6"
[0m17:04:09.919130 [debug] [Thread-4 (]: Using snowflake connection "test.openledger.not_null_staging_transactions_user_id.6e7b530ec6"
[0m17:04:09.919417 [debug] [Thread-4 (]: On test.openledger.not_null_staging_transactions_user_id.6e7b530ec6: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "openledger", "target_name": "dev", "node_id": "test.openledger.not_null_staging_transactions_user_id.6e7b530ec6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from OPENLEDGER.ANALYTICS.staging_transactions
where user_id is null



      
    ) dbt_internal_test
[0m17:04:09.919673 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:04:09.995281 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m17:04:09.997110 [debug] [Thread-1 (]: Timing info for test.openledger.accepted_values_staging_transactions_status__completed__failed__pending__declined.36daace0a3 (execute): 17:04:06.725777 => 17:04:09.996905
[0m17:04:09.997426 [debug] [Thread-1 (]: On test.openledger.accepted_values_staging_transactions_status__completed__failed__pending__declined.36daace0a3: Close
[0m17:04:10.071545 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m17:04:10.073859 [debug] [Thread-3 (]: Timing info for test.openledger.not_null_staging_transactions_amount.39c556e413 (execute): 17:04:06.729152 => 17:04:10.073667
[0m17:04:10.074170 [debug] [Thread-3 (]: On test.openledger.not_null_staging_transactions_amount.39c556e413: Close
[0m17:04:10.095286 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_staging_transactions_status__completed__failed__pending__declined  [[32mPASS[0m in 3.42s]
[0m17:04:10.095882 [debug] [Thread-1 (]: Finished running node test.openledger.accepted_values_staging_transactions_status__completed__failed__pending__declined.36daace0a3
[0m17:04:10.096269 [debug] [Thread-1 (]: Began running node test.openledger.relationships_staging_settlements_transaction_id__transaction_id__ref_staging_transactions_.90aad845a5
[0m17:04:10.096592 [info ] [Thread-1 (]: 6 of 8 START test relationships_staging_settlements_transaction_id__transaction_id__ref_staging_transactions_  [RUN]
[0m17:04:10.097183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.openledger.accepted_values_staging_transactions_status__completed__failed__pending__declined.36daace0a3, now test.openledger.relationships_staging_settlements_transaction_id__transaction_id__ref_staging_transactions_.90aad845a5)
[0m17:04:10.097497 [debug] [Thread-1 (]: Began compiling node test.openledger.relationships_staging_settlements_transaction_id__transaction_id__ref_staging_transactions_.90aad845a5
[0m17:04:10.101758 [debug] [Thread-1 (]: Writing injected SQL for node "test.openledger.relationships_staging_settlements_transaction_id__transaction_id__ref_staging_transactions_.90aad845a5"
[0m17:04:10.102366 [debug] [Thread-1 (]: Timing info for test.openledger.relationships_staging_settlements_transaction_id__transaction_id__ref_staging_transactions_.90aad845a5 (compile): 17:04:10.097698 => 17:04:10.102217
[0m17:04:10.102587 [debug] [Thread-1 (]: Began executing node test.openledger.relationships_staging_settlements_transaction_id__transaction_id__ref_staging_transactions_.90aad845a5
[0m17:04:10.104109 [debug] [Thread-1 (]: Writing runtime sql for node "test.openledger.relationships_staging_settlements_transaction_id__transaction_id__ref_staging_transactions_.90aad845a5"
[0m17:04:10.104826 [debug] [Thread-1 (]: Using snowflake connection "test.openledger.relationships_staging_settlements_transaction_id__transaction_id__ref_staging_transactions_.90aad845a5"
[0m17:04:10.105099 [debug] [Thread-1 (]: On test.openledger.relationships_staging_settlements_transaction_id__transaction_id__ref_staging_transactions_.90aad845a5: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "openledger", "target_name": "dev", "node_id": "test.openledger.relationships_staging_settlements_transaction_id__transaction_id__ref_staging_transactions_.90aad845a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select transaction_id as from_field
    from OPENLEDGER.ANALYTICS.staging_settlements
    where transaction_id is not null
),

parent as (
    select transaction_id as to_field
    from OPENLEDGER.ANALYTICS.staging_transactions
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:04:10.105447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:04:10.176702 [error] [Thread-3 (]: 3 of 8 FAIL 72 not_null_staging_transactions_amount ............................ [[31mFAIL 72[0m in 3.50s]
[0m17:04:10.177337 [debug] [Thread-3 (]: Finished running node test.openledger.not_null_staging_transactions_amount.39c556e413
[0m17:04:10.177795 [debug] [Thread-3 (]: Began running node test.openledger.unique_staging_settlements_settlement_id.3d20d2e433
[0m17:04:10.178258 [info ] [Thread-3 (]: 7 of 8 START test unique_staging_settlements_settlement_id ..................... [RUN]
[0m17:04:10.178862 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.openledger.not_null_staging_transactions_amount.39c556e413, now test.openledger.unique_staging_settlements_settlement_id.3d20d2e433)
[0m17:04:10.179133 [debug] [Thread-3 (]: Began compiling node test.openledger.unique_staging_settlements_settlement_id.3d20d2e433
[0m17:04:10.183381 [debug] [Thread-3 (]: Writing injected SQL for node "test.openledger.unique_staging_settlements_settlement_id.3d20d2e433"
[0m17:04:10.183926 [debug] [Thread-3 (]: Timing info for test.openledger.unique_staging_settlements_settlement_id.3d20d2e433 (compile): 17:04:10.179309 => 17:04:10.183743
[0m17:04:10.184198 [debug] [Thread-3 (]: Began executing node test.openledger.unique_staging_settlements_settlement_id.3d20d2e433
[0m17:04:10.185786 [debug] [Thread-3 (]: Writing runtime sql for node "test.openledger.unique_staging_settlements_settlement_id.3d20d2e433"
[0m17:04:10.186562 [debug] [Thread-3 (]: Using snowflake connection "test.openledger.unique_staging_settlements_settlement_id.3d20d2e433"
[0m17:04:10.186835 [debug] [Thread-3 (]: On test.openledger.unique_staging_settlements_settlement_id.3d20d2e433: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "openledger", "target_name": "dev", "node_id": "test.openledger.unique_staging_settlements_settlement_id.3d20d2e433"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    settlement_id as unique_field,
    count(*) as n_records

from OPENLEDGER.ANALYTICS.staging_settlements
where settlement_id is not null
group by settlement_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:04:10.187111 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:04:10.206654 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m17:04:10.209379 [debug] [Thread-2 (]: Timing info for test.openledger.not_null_staging_settlements_settlement_id.1b418a3038 (execute): 17:04:06.709993 => 17:04:10.209092
[0m17:04:10.209938 [debug] [Thread-2 (]: On test.openledger.not_null_staging_settlements_settlement_id.1b418a3038: Close
[0m17:04:10.308268 [info ] [Thread-2 (]: 2 of 8 PASS not_null_staging_settlements_settlement_id ......................... [[32mPASS[0m in 3.63s]
[0m17:04:10.308911 [debug] [Thread-2 (]: Finished running node test.openledger.not_null_staging_settlements_settlement_id.1b418a3038
[0m17:04:10.309245 [debug] [Thread-2 (]: Began running node test.openledger.unique_staging_transactions_transaction_id.fdabedfb57
[0m17:04:10.309651 [info ] [Thread-2 (]: 8 of 8 START test unique_staging_transactions_transaction_id ................... [RUN]
[0m17:04:10.310156 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.openledger.not_null_staging_settlements_settlement_id.1b418a3038, now test.openledger.unique_staging_transactions_transaction_id.fdabedfb57)
[0m17:04:10.310412 [debug] [Thread-2 (]: Began compiling node test.openledger.unique_staging_transactions_transaction_id.fdabedfb57
[0m17:04:10.313153 [debug] [Thread-2 (]: Writing injected SQL for node "test.openledger.unique_staging_transactions_transaction_id.fdabedfb57"
[0m17:04:10.313692 [debug] [Thread-2 (]: Timing info for test.openledger.unique_staging_transactions_transaction_id.fdabedfb57 (compile): 17:04:10.310577 => 17:04:10.313552
[0m17:04:10.313900 [debug] [Thread-2 (]: Began executing node test.openledger.unique_staging_transactions_transaction_id.fdabedfb57
[0m17:04:10.315211 [debug] [Thread-2 (]: Writing runtime sql for node "test.openledger.unique_staging_transactions_transaction_id.fdabedfb57"
[0m17:04:10.315835 [debug] [Thread-2 (]: Using snowflake connection "test.openledger.unique_staging_transactions_transaction_id.fdabedfb57"
[0m17:04:10.316105 [debug] [Thread-2 (]: On test.openledger.unique_staging_transactions_transaction_id.fdabedfb57: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "openledger", "target_name": "dev", "node_id": "test.openledger.unique_staging_transactions_transaction_id.fdabedfb57"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from OPENLEDGER.ANALYTICS.staging_transactions
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:04:10.316361 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:04:12.348937 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m17:04:12.351304 [debug] [Thread-4 (]: Timing info for test.openledger.not_null_staging_transactions_user_id.6e7b530ec6 (execute): 17:04:09.917060 => 17:04:12.351125
[0m17:04:12.351769 [debug] [Thread-4 (]: On test.openledger.not_null_staging_transactions_user_id.6e7b530ec6: Close
[0m17:04:12.451242 [warn ] [Thread-4 (]: 5 of 8 WARN 67 not_null_staging_transactions_user_id ........................... [[33mWARN 67[0m in 2.54s]
[0m17:04:12.451915 [debug] [Thread-4 (]: Finished running node test.openledger.not_null_staging_transactions_user_id.6e7b530ec6
[0m17:04:12.641463 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m17:04:12.643205 [debug] [Thread-1 (]: Timing info for test.openledger.relationships_staging_settlements_transaction_id__transaction_id__ref_staging_transactions_.90aad845a5 (execute): 17:04:10.102753 => 17:04:12.643024
[0m17:04:12.643507 [debug] [Thread-1 (]: On test.openledger.relationships_staging_settlements_transaction_id__transaction_id__ref_staging_transactions_.90aad845a5: Close
[0m17:04:12.728742 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m17:04:12.730553 [debug] [Thread-3 (]: Timing info for test.openledger.unique_staging_settlements_settlement_id.3d20d2e433 (execute): 17:04:10.184372 => 17:04:12.730390
[0m17:04:12.730851 [debug] [Thread-3 (]: On test.openledger.unique_staging_settlements_settlement_id.3d20d2e433: Close
[0m17:04:12.737919 [warn ] [Thread-1 (]: 6 of 8 WARN 31 relationships_staging_settlements_transaction_id__transaction_id__ref_staging_transactions_  [[33mWARN 31[0m in 2.64s]
[0m17:04:12.738520 [debug] [Thread-1 (]: Finished running node test.openledger.relationships_staging_settlements_transaction_id__transaction_id__ref_staging_transactions_.90aad845a5
[0m17:04:12.778672 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m17:04:12.780642 [debug] [Thread-2 (]: Timing info for test.openledger.unique_staging_transactions_transaction_id.fdabedfb57 (execute): 17:04:10.314044 => 17:04:12.780486
[0m17:04:12.780925 [debug] [Thread-2 (]: On test.openledger.unique_staging_transactions_transaction_id.fdabedfb57: Close
[0m17:04:12.826380 [info ] [Thread-3 (]: 7 of 8 PASS unique_staging_settlements_settlement_id ........................... [[32mPASS[0m in 2.65s]
[0m17:04:12.827039 [debug] [Thread-3 (]: Finished running node test.openledger.unique_staging_settlements_settlement_id.3d20d2e433
[0m17:04:12.895953 [warn ] [Thread-2 (]: 8 of 8 WARN 72 unique_staging_transactions_transaction_id ...................... [[33mWARN 72[0m in 2.59s]
[0m17:04:12.896570 [debug] [Thread-2 (]: Finished running node test.openledger.unique_staging_transactions_transaction_id.fdabedfb57
[0m17:04:12.899215 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:04:12.899505 [debug] [MainThread]: Connection 'test.openledger.relationships_staging_settlements_transaction_id__transaction_id__ref_staging_transactions_.90aad845a5' was properly closed.
[0m17:04:12.899740 [debug] [MainThread]: Connection 'test.openledger.unique_staging_transactions_transaction_id.fdabedfb57' was properly closed.
[0m17:04:12.899963 [debug] [MainThread]: Connection 'test.openledger.unique_staging_settlements_settlement_id.3d20d2e433' was properly closed.
[0m17:04:12.900174 [debug] [MainThread]: Connection 'test.openledger.not_null_staging_transactions_user_id.6e7b530ec6' was properly closed.
[0m17:04:12.900433 [info ] [MainThread]: 
[0m17:04:12.900723 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 9.79 seconds (9.79s).
[0m17:04:12.901781 [debug] [MainThread]: Command end result
[0m17:04:12.909191 [info ] [MainThread]: 
[0m17:04:12.909663 [info ] [MainThread]: [31mCompleted with 1 error and 3 warnings:[0m
[0m17:04:12.909981 [info ] [MainThread]: 
[0m17:04:12.910294 [error] [MainThread]: [31mFailure in test not_null_staging_transactions_amount (models/staging/schema.yml)[0m
[0m17:04:12.910580 [error] [MainThread]:   Got 72 results, configured to fail if != 0
[0m17:04:12.910849 [info ] [MainThread]: 
[0m17:04:12.911139 [info ] [MainThread]:   compiled Code at target/compiled/openledger/models/staging/schema.yml/not_null_staging_transactions_amount.sql
[0m17:04:12.911416 [info ] [MainThread]: 
[0m17:04:12.911699 [warn ] [MainThread]: [33mWarning in test not_null_staging_transactions_user_id (models/staging/schema.yml)[0m
[0m17:04:12.911980 [warn ] [MainThread]: Got 67 results, configured to warn if != 0
[0m17:04:12.912241 [info ] [MainThread]: 
[0m17:04:12.912496 [info ] [MainThread]:   compiled Code at target/compiled/openledger/models/staging/schema.yml/not_null_staging_transactions_user_id.sql
[0m17:04:12.912761 [info ] [MainThread]: 
[0m17:04:12.913043 [warn ] [MainThread]: [33mWarning in test relationships_staging_settlements_transaction_id__transaction_id__ref_staging_transactions_ (models/staging/schema.yml)[0m
[0m17:04:12.913313 [warn ] [MainThread]: Got 31 results, configured to warn if != 0
[0m17:04:12.913603 [info ] [MainThread]: 
[0m17:04:12.913861 [info ] [MainThread]:   compiled Code at target/compiled/openledger/models/staging/schema.yml/relationships_staging_settleme_37a32852b4aaeb694112b3bbcb488a82.sql
[0m17:04:12.914122 [info ] [MainThread]: 
[0m17:04:12.914381 [warn ] [MainThread]: [33mWarning in test unique_staging_transactions_transaction_id (models/staging/schema.yml)[0m
[0m17:04:12.914634 [warn ] [MainThread]: Got 72 results, configured to warn if != 0
[0m17:04:12.914890 [info ] [MainThread]: 
[0m17:04:12.915163 [info ] [MainThread]:   compiled Code at target/compiled/openledger/models/staging/schema.yml/unique_staging_transactions_transaction_id.sql
[0m17:04:12.915433 [info ] [MainThread]: 
[0m17:04:12.915732 [info ] [MainThread]: Done. PASS=4 WARN=3 ERROR=1 SKIP=0 TOTAL=8
[0m17:04:12.917463 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 11.172154, "process_user_time": 2.765367, "process_kernel_time": 1.907702, "process_mem_max_rss": "199416", "process_in_blocks": "169776", "process_out_blocks": "2928", "command_success": false}
[0m17:04:12.918012 [debug] [MainThread]: Command `dbt test` failed at 17:04:12.917903 after 11.17 seconds
[0m17:04:12.918460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6f0f9f3f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6ee367eba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6ee32a6b10>]}
[0m17:04:12.918987 [debug] [MainThread]: Flushing usage events
[0m17:06:23.612219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728728ae4530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728728f32ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728728ae4200>]}


============================== 17:06:23.617236 | c374a538-2f28-4c1c-8d13-18574a1ddf97 ==============================
[0m17:06:23.617236 [info ] [MainThread]: Running with dbt=1.7.19
[0m17:06:23.617817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/dchit/projects/open-ledger/dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/dchit/projects/open-ledger/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select fct_transactions', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:06:24.704622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c374a538-2f28-4c1c-8d13-18574a1ddf97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728729c58380>]}
[0m17:06:24.740975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c374a538-2f28-4c1c-8d13-18574a1ddf97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7286fd20b470>]}
[0m17:06:24.742286 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m17:06:24.747258 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m17:06:24.810376 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:06:24.811124 [debug] [MainThread]: Partial parsing: added file: openledger://models/marts/fct_transactions.sql
[0m17:06:24.908434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c374a538-2f28-4c1c-8d13-18574a1ddf97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7286fcd1b0e0>]}
[0m17:06:24.915413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c374a538-2f28-4c1c-8d13-18574a1ddf97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7286fc57b770>]}
[0m17:06:24.915837 [info ] [MainThread]: Found 4 models, 8 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m17:06:24.916140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c374a538-2f28-4c1c-8d13-18574a1ddf97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7286fc66a300>]}
[0m17:06:24.917195 [info ] [MainThread]: 
[0m17:06:24.917781 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:06:24.919023 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_OPENLEDGER'
[0m17:06:24.929011 [debug] [ThreadPool]: Using snowflake connection "list_OPENLEDGER"
[0m17:06:24.929421 [debug] [ThreadPool]: On list_OPENLEDGER: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "openledger", "target_name": "dev", "connection_name": "list_OPENLEDGER"} */
show terse schemas in database OPENLEDGER
    limit 10000
[0m17:06:24.929698 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:28.304341 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m17:06:28.305877 [debug] [ThreadPool]: On list_OPENLEDGER: Close
[0m17:06:28.404477 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_OPENLEDGER, now list_OPENLEDGER_ANALYTICS)
[0m17:06:28.410155 [debug] [ThreadPool]: Using snowflake connection "list_OPENLEDGER_ANALYTICS"
[0m17:06:28.410450 [debug] [ThreadPool]: On list_OPENLEDGER_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "openledger", "target_name": "dev", "connection_name": "list_OPENLEDGER_ANALYTICS"} */
show terse objects in OPENLEDGER.ANALYTICS limit 10000
[0m17:06:28.410697 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:06:30.852139 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m17:06:30.853679 [debug] [ThreadPool]: On list_OPENLEDGER_ANALYTICS: Close
[0m17:06:30.964962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c374a538-2f28-4c1c-8d13-18574a1ddf97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728728e5f8c0>]}
[0m17:06:30.966106 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:06:30.966448 [info ] [MainThread]: 
[0m17:06:30.969575 [debug] [Thread-1 (]: Began running node model.openledger.fct_transactions
[0m17:06:30.970004 [info ] [Thread-1 (]: 1 of 1 START sql table model ANALYTICS.fct_transactions ........................ [RUN]
[0m17:06:30.970461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_OPENLEDGER_ANALYTICS, now model.openledger.fct_transactions)
[0m17:06:30.970726 [debug] [Thread-1 (]: Began compiling node model.openledger.fct_transactions
[0m17:06:30.975145 [debug] [Thread-1 (]: Writing injected SQL for node "model.openledger.fct_transactions"
[0m17:06:30.980127 [debug] [Thread-1 (]: Timing info for model.openledger.fct_transactions (compile): 17:06:30.970901 => 17:06:30.979859
[0m17:06:30.980459 [debug] [Thread-1 (]: Began executing node model.openledger.fct_transactions
[0m17:06:31.000898 [debug] [Thread-1 (]: Writing runtime sql for node "model.openledger.fct_transactions"
[0m17:06:31.003210 [debug] [Thread-1 (]: Using snowflake connection "model.openledger.fct_transactions"
[0m17:06:31.003564 [debug] [Thread-1 (]: On model.openledger.fct_transactions: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "openledger", "target_name": "dev", "node_id": "model.openledger.fct_transactions"} */
create or replace transient table OPENLEDGER.ANALYTICS.fct_transactions
         as
        (

WITH internal AS (
    SELECT * FROM OPENLEDGER.ANALYTICS.staging_transactions
),

external AS (
    SELECT * FROM OPENLEDGER.ANALYTICS.staging_settlements
),

joined AS (
    SELECT
        -- COALESCE ensures we keep the ID even if it's missing from one side
        COALESCE(i.transaction_id, e.transaction_id) AS transaction_id,
        
        -- Dimensions
        i.user_id,
        i.merchant_id,
        i.event_time AS transaction_at,
        e.settlement_date,
        
        -- Metrics
        i.amount AS internal_amount,
        e.net_amount AS bank_settled_amount,
        e.fee_amount AS bank_fee,
        
        -- Calculating the difference (0 == perfect match)
        -- Handling null values by treating them as 0
        ZEROIFNULL(e.net_amount) - ZEROIFNULL(i.amount) AS reconciliation_delta
        
    FROM internal i
    FULL OUTER JOIN external e 
        ON i.transaction_id = e.transaction_id
)

SELECT
    *,
    CASE
        WHEN internal_amount IS NOT NULL AND bank_settled_amount IS NULL THEN 'MISSING_EXTERNAL'
        WHEN internal_amount IS NULL AND bank_settled_amount IS NOT NULL THEN 'MISSING_INTERNAL'
        WHEN internal_amount = bank_settled_amount THEN 'MATCHED'
        ELSE 'DISCREPANCY'
    END AS reconciliation_status
FROM joined
        );
[0m17:06:31.003876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:34.483697 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m17:06:34.494090 [debug] [Thread-1 (]: Timing info for model.openledger.fct_transactions (execute): 17:06:30.980629 => 17:06:34.493961
[0m17:06:34.494372 [debug] [Thread-1 (]: On model.openledger.fct_transactions: Close
[0m17:06:34.586197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c374a538-2f28-4c1c-8d13-18574a1ddf97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7286a76326f0>]}
[0m17:06:34.586815 [info ] [Thread-1 (]: 1 of 1 OK created sql table model ANALYTICS.fct_transactions ................... [[32mSUCCESS 1[0m in 3.62s]
[0m17:06:34.587348 [debug] [Thread-1 (]: Finished running node model.openledger.fct_transactions
[0m17:06:34.589697 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:06:34.589931 [debug] [MainThread]: Connection 'model.openledger.fct_transactions' was properly closed.
[0m17:06:34.590161 [info ] [MainThread]: 
[0m17:06:34.590427 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.67 seconds (9.67s).
[0m17:06:34.591313 [debug] [MainThread]: Command end result
[0m17:06:34.596864 [info ] [MainThread]: 
[0m17:06:34.597282 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:06:34.597606 [info ] [MainThread]: 
[0m17:06:34.597896 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:06:34.599670 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.02272, "process_user_time": 2.366551, "process_kernel_time": 1.813955, "process_mem_max_rss": "192708", "process_in_blocks": "170400", "process_out_blocks": "2784"}
[0m17:06:34.600490 [debug] [MainThread]: Command `dbt run` succeeded at 17:06:34.600354 after 11.02 seconds
[0m17:06:34.600799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728728edac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728728f32ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7286fc574b00>]}
[0m17:06:34.601099 [debug] [MainThread]: Flushing usage events
[0m17:07:57.662435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b1d63cd7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b1d691aab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b1d63cd6a0>]}


============================== 17:07:57.666188 | 8a27de4d-955e-4467-96f7-b0700ea4766d ==============================
[0m17:07:57.666188 [info ] [MainThread]: Running with dbt=1.7.19
[0m17:07:57.666664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/dchit/projects/open-ledger/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/dchit/projects/open-ledger/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:07:58.667088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a27de4d-955e-4467-96f7-b0700ea4766d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b1d6409490>]}
[0m17:07:58.706872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a27de4d-955e-4467-96f7-b0700ea4766d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b1ac3b2120>]}
[0m17:07:58.708777 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m17:07:58.714370 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m17:07:58.777179 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:07:58.777616 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:07:58.781340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a27de4d-955e-4467-96f7-b0700ea4766d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b1aa119370>]}
[0m17:07:58.783526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a27de4d-955e-4467-96f7-b0700ea4766d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b1a9e4cc50>]}
[0m17:07:58.783895 [info ] [MainThread]: Found 4 models, 8 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m17:07:58.784203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a27de4d-955e-4467-96f7-b0700ea4766d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b1aad9f620>]}
[0m17:07:58.785706 [info ] [MainThread]: 
[0m17:07:58.786350 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:07:58.787950 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_OPENLEDGER_ANALYTICS'
[0m17:07:58.800049 [debug] [ThreadPool]: Using snowflake connection "list_OPENLEDGER_ANALYTICS"
[0m17:07:58.800455 [debug] [ThreadPool]: On list_OPENLEDGER_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "openledger", "target_name": "dev", "connection_name": "list_OPENLEDGER_ANALYTICS"} */
show terse objects in OPENLEDGER.ANALYTICS limit 10000
[0m17:07:58.800701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:02.732126 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 4.0 seconds
[0m17:08:02.733915 [debug] [ThreadPool]: On list_OPENLEDGER_ANALYTICS: Close
[0m17:08:02.830210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a27de4d-955e-4467-96f7-b0700ea4766d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b1ac9e03b0>]}
[0m17:08:02.830956 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:08:02.831274 [info ] [MainThread]: 
[0m17:08:02.834391 [debug] [Thread-1 (]: Began running node model.openledger.staging_entries
[0m17:08:02.834823 [debug] [Thread-2 (]: Began running node model.openledger.staging_settlements
[0m17:08:02.835253 [debug] [Thread-3 (]: Began running node model.openledger.staging_transactions
[0m17:08:02.835734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_OPENLEDGER_ANALYTICS, now model.openledger.staging_entries)
[0m17:08:02.836634 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.openledger.staging_settlements'
[0m17:08:02.837636 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.openledger.staging_transactions'
[0m17:08:02.837970 [debug] [Thread-1 (]: Began compiling node model.openledger.staging_entries
[0m17:08:02.838316 [debug] [Thread-2 (]: Began compiling node model.openledger.staging_settlements
[0m17:08:02.838840 [debug] [Thread-3 (]: Began compiling node model.openledger.staging_transactions
[0m17:08:02.843780 [debug] [Thread-1 (]: Writing injected SQL for node "model.openledger.staging_entries"
[0m17:08:02.846365 [debug] [Thread-2 (]: Writing injected SQL for node "model.openledger.staging_settlements"
[0m17:08:02.848651 [debug] [Thread-3 (]: Writing injected SQL for node "model.openledger.staging_transactions"
[0m17:08:02.849951 [debug] [Thread-2 (]: Timing info for model.openledger.staging_settlements (compile): 17:08:02.844404 => 17:08:02.849685
[0m17:08:02.850419 [debug] [Thread-2 (]: Began executing node model.openledger.staging_settlements
[0m17:08:02.850840 [debug] [Thread-1 (]: Timing info for model.openledger.staging_entries (compile): 17:08:02.839250 => 17:08:02.850616
[0m17:08:02.851474 [debug] [Thread-2 (]: Timing info for model.openledger.staging_settlements (execute): 17:08:02.851319 => 17:08:02.851345
[0m17:08:02.851911 [debug] [Thread-3 (]: Timing info for model.openledger.staging_transactions (compile): 17:08:02.846763 => 17:08:02.851760
[0m17:08:02.852192 [debug] [Thread-1 (]: Began executing node model.openledger.staging_entries
[0m17:08:02.853303 [debug] [Thread-2 (]: Finished running node model.openledger.staging_settlements
[0m17:08:02.853840 [debug] [Thread-3 (]: Began executing node model.openledger.staging_transactions
[0m17:08:02.854337 [debug] [Thread-1 (]: Timing info for model.openledger.staging_entries (execute): 17:08:02.854180 => 17:08:02.854187
[0m17:08:02.855112 [debug] [Thread-3 (]: Timing info for model.openledger.staging_transactions (execute): 17:08:02.854955 => 17:08:02.854961
[0m17:08:02.856284 [debug] [Thread-1 (]: Finished running node model.openledger.staging_entries
[0m17:08:02.856685 [debug] [Thread-4 (]: Began running node test.openledger.not_null_staging_settlements_settlement_id.1b418a3038
[0m17:08:02.857274 [debug] [Thread-2 (]: Began running node test.openledger.unique_staging_settlements_settlement_id.3d20d2e433
[0m17:08:02.858340 [debug] [Thread-3 (]: Finished running node model.openledger.staging_transactions
[0m17:08:02.861222 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.openledger.not_null_staging_settlements_settlement_id.1b418a3038'
[0m17:08:02.862101 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.openledger.staging_settlements, now test.openledger.unique_staging_settlements_settlement_id.3d20d2e433)
[0m17:08:02.863290 [debug] [Thread-1 (]: Began running node model.openledger.fct_transactions
[0m17:08:02.863816 [debug] [Thread-4 (]: Began compiling node test.openledger.not_null_staging_settlements_settlement_id.1b418a3038
[0m17:08:02.864108 [debug] [Thread-3 (]: Began running node test.openledger.accepted_values_staging_transactions_status__completed__failed__pending__declined.36daace0a3
[0m17:08:02.864591 [debug] [Thread-2 (]: Began compiling node test.openledger.unique_staging_settlements_settlement_id.3d20d2e433
[0m17:08:02.865279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.openledger.staging_entries, now model.openledger.fct_transactions)
[0m17:08:02.876902 [debug] [Thread-4 (]: Writing injected SQL for node "test.openledger.not_null_staging_settlements_settlement_id.1b418a3038"
[0m17:08:02.878154 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.openledger.staging_transactions, now test.openledger.accepted_values_staging_transactions_status__completed__failed__pending__declined.36daace0a3)
[0m17:08:02.883546 [debug] [Thread-2 (]: Writing injected SQL for node "test.openledger.unique_staging_settlements_settlement_id.3d20d2e433"
[0m17:08:02.884079 [debug] [Thread-1 (]: Began compiling node model.openledger.fct_transactions
[0m17:08:02.884825 [debug] [Thread-3 (]: Began compiling node test.openledger.accepted_values_staging_transactions_status__completed__failed__pending__declined.36daace0a3
[0m17:08:02.885766 [debug] [Thread-4 (]: Timing info for test.openledger.not_null_staging_settlements_settlement_id.1b418a3038 (compile): 17:08:02.865743 => 17:08:02.885449
[0m17:08:02.887911 [debug] [Thread-1 (]: Writing injected SQL for node "model.openledger.fct_transactions"
[0m17:08:02.888667 [debug] [Thread-2 (]: Timing info for test.openledger.unique_staging_settlements_settlement_id.3d20d2e433 (compile): 17:08:02.878631 => 17:08:02.888365
[0m17:08:02.896011 [debug] [Thread-3 (]: Writing injected SQL for node "test.openledger.accepted_values_staging_transactions_status__completed__failed__pending__declined.36daace0a3"
[0m17:08:02.896602 [debug] [Thread-4 (]: Began executing node test.openledger.not_null_staging_settlements_settlement_id.1b418a3038
[0m17:08:02.897279 [debug] [Thread-2 (]: Began executing node test.openledger.unique_staging_settlements_settlement_id.3d20d2e433
[0m17:08:02.898009 [debug] [Thread-1 (]: Timing info for model.openledger.fct_transactions (compile): 17:08:02.886232 => 17:08:02.897832
[0m17:08:02.898432 [debug] [Thread-4 (]: Timing info for test.openledger.not_null_staging_settlements_settlement_id.1b418a3038 (execute): 17:08:02.898282 => 17:08:02.898293
[0m17:08:02.898778 [debug] [Thread-3 (]: Timing info for test.openledger.accepted_values_staging_transactions_status__completed__failed__pending__declined.36daace0a3 (compile): 17:08:02.888961 => 17:08:02.898627
[0m17:08:02.899163 [debug] [Thread-2 (]: Timing info for test.openledger.unique_staging_settlements_settlement_id.3d20d2e433 (execute): 17:08:02.898989 => 17:08:02.898994
[0m17:08:02.899475 [debug] [Thread-1 (]: Began executing node model.openledger.fct_transactions
[0m17:08:02.900149 [debug] [Thread-4 (]: Finished running node test.openledger.not_null_staging_settlements_settlement_id.1b418a3038
[0m17:08:02.900456 [debug] [Thread-3 (]: Began executing node test.openledger.accepted_values_staging_transactions_status__completed__failed__pending__declined.36daace0a3
[0m17:08:02.901056 [debug] [Thread-2 (]: Finished running node test.openledger.unique_staging_settlements_settlement_id.3d20d2e433
[0m17:08:02.901727 [debug] [Thread-1 (]: Timing info for model.openledger.fct_transactions (execute): 17:08:02.901370 => 17:08:02.901451
[0m17:08:02.902218 [debug] [Thread-4 (]: Began running node test.openledger.not_null_staging_transactions_amount.39c556e413
[0m17:08:02.902665 [debug] [Thread-3 (]: Timing info for test.openledger.accepted_values_staging_transactions_status__completed__failed__pending__declined.36daace0a3 (execute): 17:08:02.902523 => 17:08:02.902529
[0m17:08:02.903013 [debug] [Thread-2 (]: Began running node test.openledger.not_null_staging_transactions_transaction_id.d4f9e42898
[0m17:08:02.903630 [debug] [Thread-1 (]: Finished running node model.openledger.fct_transactions
[0m17:08:02.904066 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.openledger.not_null_staging_settlements_settlement_id.1b418a3038, now test.openledger.not_null_staging_transactions_amount.39c556e413)
[0m17:08:02.904743 [debug] [Thread-3 (]: Finished running node test.openledger.accepted_values_staging_transactions_status__completed__failed__pending__declined.36daace0a3
[0m17:08:02.905280 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.openledger.unique_staging_settlements_settlement_id.3d20d2e433, now test.openledger.not_null_staging_transactions_transaction_id.d4f9e42898)
[0m17:08:02.905868 [debug] [Thread-1 (]: Began running node test.openledger.not_null_staging_transactions_user_id.6e7b530ec6
[0m17:08:02.906281 [debug] [Thread-4 (]: Began compiling node test.openledger.not_null_staging_transactions_amount.39c556e413
[0m17:08:02.906641 [debug] [Thread-3 (]: Began running node test.openledger.relationships_staging_settlements_transaction_id__transaction_id__ref_staging_transactions_.90aad845a5
[0m17:08:02.907014 [debug] [Thread-2 (]: Began compiling node test.openledger.not_null_staging_transactions_transaction_id.d4f9e42898
[0m17:08:02.907462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.openledger.fct_transactions, now test.openledger.not_null_staging_transactions_user_id.6e7b530ec6)
[0m17:08:02.910254 [debug] [Thread-4 (]: Writing injected SQL for node "test.openledger.not_null_staging_transactions_amount.39c556e413"
[0m17:08:02.911002 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.openledger.accepted_values_staging_transactions_status__completed__failed__pending__declined.36daace0a3, now test.openledger.relationships_staging_settlements_transaction_id__transaction_id__ref_staging_transactions_.90aad845a5)
[0m17:08:02.913481 [debug] [Thread-2 (]: Writing injected SQL for node "test.openledger.not_null_staging_transactions_transaction_id.d4f9e42898"
[0m17:08:02.913992 [debug] [Thread-1 (]: Began compiling node test.openledger.not_null_staging_transactions_user_id.6e7b530ec6
[0m17:08:02.914678 [debug] [Thread-3 (]: Began compiling node test.openledger.relationships_staging_settlements_transaction_id__transaction_id__ref_staging_transactions_.90aad845a5
[0m17:08:02.918093 [debug] [Thread-1 (]: Writing injected SQL for node "test.openledger.not_null_staging_transactions_user_id.6e7b530ec6"
[0m17:08:02.918663 [debug] [Thread-4 (]: Timing info for test.openledger.not_null_staging_transactions_amount.39c556e413 (compile): 17:08:02.907720 => 17:08:02.918382
[0m17:08:02.919312 [debug] [Thread-2 (]: Timing info for test.openledger.not_null_staging_transactions_transaction_id.d4f9e42898 (compile): 17:08:02.911371 => 17:08:02.919029
[0m17:08:02.924205 [debug] [Thread-3 (]: Writing injected SQL for node "test.openledger.relationships_staging_settlements_transaction_id__transaction_id__ref_staging_transactions_.90aad845a5"
[0m17:08:02.924874 [debug] [Thread-4 (]: Began executing node test.openledger.not_null_staging_transactions_amount.39c556e413
[0m17:08:02.925355 [debug] [Thread-2 (]: Began executing node test.openledger.not_null_staging_transactions_transaction_id.d4f9e42898
[0m17:08:02.925978 [debug] [Thread-1 (]: Timing info for test.openledger.not_null_staging_transactions_user_id.6e7b530ec6 (compile): 17:08:02.915419 => 17:08:02.925696
[0m17:08:02.926411 [debug] [Thread-4 (]: Timing info for test.openledger.not_null_staging_transactions_amount.39c556e413 (execute): 17:08:02.926267 => 17:08:02.926276
[0m17:08:02.926788 [debug] [Thread-2 (]: Timing info for test.openledger.not_null_staging_transactions_transaction_id.d4f9e42898 (execute): 17:08:02.926642 => 17:08:02.926648
[0m17:08:02.927150 [debug] [Thread-3 (]: Timing info for test.openledger.relationships_staging_settlements_transaction_id__transaction_id__ref_staging_transactions_.90aad845a5 (compile): 17:08:02.919598 => 17:08:02.927001
[0m17:08:02.927461 [debug] [Thread-1 (]: Began executing node test.openledger.not_null_staging_transactions_user_id.6e7b530ec6
[0m17:08:02.928089 [debug] [Thread-4 (]: Finished running node test.openledger.not_null_staging_transactions_amount.39c556e413
[0m17:08:02.928843 [debug] [Thread-2 (]: Finished running node test.openledger.not_null_staging_transactions_transaction_id.d4f9e42898
[0m17:08:02.929252 [debug] [Thread-3 (]: Began executing node test.openledger.relationships_staging_settlements_transaction_id__transaction_id__ref_staging_transactions_.90aad845a5
[0m17:08:02.929885 [debug] [Thread-1 (]: Timing info for test.openledger.not_null_staging_transactions_user_id.6e7b530ec6 (execute): 17:08:02.929606 => 17:08:02.929617
[0m17:08:02.930357 [debug] [Thread-4 (]: Began running node test.openledger.unique_staging_transactions_transaction_id.fdabedfb57
[0m17:08:02.931332 [debug] [Thread-3 (]: Timing info for test.openledger.relationships_staging_settlements_transaction_id__transaction_id__ref_staging_transactions_.90aad845a5 (execute): 17:08:02.931056 => 17:08:02.931067
[0m17:08:02.931996 [debug] [Thread-1 (]: Finished running node test.openledger.not_null_staging_transactions_user_id.6e7b530ec6
[0m17:08:02.932425 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.openledger.not_null_staging_transactions_amount.39c556e413, now test.openledger.unique_staging_transactions_transaction_id.fdabedfb57)
[0m17:08:02.932980 [debug] [Thread-3 (]: Finished running node test.openledger.relationships_staging_settlements_transaction_id__transaction_id__ref_staging_transactions_.90aad845a5
[0m17:08:02.933530 [debug] [Thread-4 (]: Began compiling node test.openledger.unique_staging_transactions_transaction_id.fdabedfb57
[0m17:08:02.936257 [debug] [Thread-4 (]: Writing injected SQL for node "test.openledger.unique_staging_transactions_transaction_id.fdabedfb57"
[0m17:08:02.936671 [debug] [Thread-4 (]: Timing info for test.openledger.unique_staging_transactions_transaction_id.fdabedfb57 (compile): 17:08:02.933924 => 17:08:02.936531
[0m17:08:02.936911 [debug] [Thread-4 (]: Began executing node test.openledger.unique_staging_transactions_transaction_id.fdabedfb57
[0m17:08:02.937208 [debug] [Thread-4 (]: Timing info for test.openledger.unique_staging_transactions_transaction_id.fdabedfb57 (execute): 17:08:02.937076 => 17:08:02.937081
[0m17:08:02.937769 [debug] [Thread-4 (]: Finished running node test.openledger.unique_staging_transactions_transaction_id.fdabedfb57
[0m17:08:02.939586 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:08:02.939855 [debug] [MainThread]: Connection 'test.openledger.not_null_staging_transactions_user_id.6e7b530ec6' was properly closed.
[0m17:08:02.940085 [debug] [MainThread]: Connection 'test.openledger.not_null_staging_transactions_transaction_id.d4f9e42898' was properly closed.
[0m17:08:02.940295 [debug] [MainThread]: Connection 'test.openledger.relationships_staging_settlements_transaction_id__transaction_id__ref_staging_transactions_.90aad845a5' was properly closed.
[0m17:08:02.940528 [debug] [MainThread]: Connection 'test.openledger.unique_staging_transactions_transaction_id.fdabedfb57' was properly closed.
[0m17:08:02.941675 [debug] [MainThread]: Command end result
[0m17:08:02.957832 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m17:08:02.958146 [info ] [MainThread]: Building catalog
[0m17:08:02.960026 [debug] [ThreadPool]: Acquiring new snowflake connection 'OPENLEDGER.information_schema'
[0m17:08:02.968201 [debug] [ThreadPool]: Using snowflake connection "OPENLEDGER.information_schema"
[0m17:08:02.968643 [debug] [ThreadPool]: On OPENLEDGER.information_schema: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "openledger", "target_name": "dev", "connection_name": "OPENLEDGER.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        coalesce(table_type, 'DYNAMIC TABLE') as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from OPENLEDGER.INFORMATION_SCHEMA.tables
            where (
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('transactions')
                )
             or 
                (
                    upper("table_schema") = upper('ANALYTICS')
                    and upper("table_name") = upper('staging_entries')
                )
             or 
                (
                    upper("table_schema") = upper('ANALYTICS')
                    and upper("table_name") = upper('staging_transactions')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('settlements')
                )
             or 
                (
                    upper("table_schema") = upper('ANALYTICS')
                    and upper("table_name") = upper('staging_settlements')
                )
             or 
                (
                    upper("table_schema") = upper('ANALYTICS')
                    and upper("table_name") = upper('fct_transactions')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('ledger_entries')
                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from OPENLEDGER.INFORMATION_SCHEMA.columns
            where (
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('transactions')
                )
             or 
                (
                    upper("table_schema") = upper('ANALYTICS')
                    and upper("table_name") = upper('staging_entries')
                )
             or 
                (
                    upper("table_schema") = upper('ANALYTICS')
                    and upper("table_name") = upper('staging_transactions')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('settlements')
                )
             or 
                (
                    upper("table_schema") = upper('ANALYTICS')
                    and upper("table_name") = upper('staging_settlements')
                )
             or 
                (
                    upper("table_schema") = upper('ANALYTICS')
                    and upper("table_name") = upper('fct_transactions')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('ledger_entries')
                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m17:08:02.968960 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:09.454832 [debug] [ThreadPool]: SQL status: SUCCESS 62 in 6.0 seconds
[0m17:08:09.461784 [debug] [ThreadPool]: On OPENLEDGER.information_schema: Close
[0m17:08:09.571308 [info ] [MainThread]: Catalog written to /home/dchit/projects/open-ledger/dbt/target/catalog.json
[0m17:08:09.572589 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 11.9388685, "process_user_time": 2.285447, "process_kernel_time": 1.796729, "process_mem_max_rss": "191940", "process_in_blocks": "172840", "process_out_blocks": "5016"}
[0m17:08:09.572989 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:08:09.572882 after 11.94 seconds
[0m17:08:09.573230 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:08:09.573490 [debug] [MainThread]: Connection 'OPENLEDGER.information_schema' was properly closed.
[0m17:08:09.573722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b1d676e330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b1d70a8b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b1aa5ed700>]}
[0m17:08:09.573973 [debug] [MainThread]: Flushing usage events
[0m17:08:18.096761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21a31dd310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21a357e330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21a3622ab0>]}


============================== 17:08:18.099231 | 4d713994-db39-435d-ac4b-b122fc84b62f ==============================
[0m17:08:18.099231 [info ] [MainThread]: Running with dbt=1.7.19
[0m17:08:18.099707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/dchit/projects/open-ledger/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/dchit/projects/open-ledger/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:08:18.588083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d713994-db39-435d-ac4b-b122fc84b62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2176e2e810>]}
[0m17:08:18.621902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d713994-db39-435d-ac4b-b122fc84b62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21a31dcfb0>]}
[0m17:08:56.995832 [error] [MainThread]: Encountered an error:

[0m17:08:57.009144 [error] [MainThread]: Traceback (most recent call last):
  File "/home/dchit/projects/open-ledger/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dchit/projects/open-ledger/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dchit/projects/open-ledger/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dchit/projects/open-ledger/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dchit/projects/open-ledger/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dchit/projects/open-ledger/venv/lib/python3.12/site-packages/dbt/cli/main.py", line 325, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/dchit/projects/open-ledger/venv/lib/python3.12/site-packages/dbt/task/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m17:08:57.013012 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 38.942493, "process_user_time": 1.695171, "process_kernel_time": 1.28326, "process_mem_max_rss": "169076", "process_in_blocks": "1176", "process_out_blocks": "2952", "command_success": false}
[0m17:08:57.014354 [debug] [MainThread]: Command `dbt docs serve` failed at 17:08:57.014214 after 38.94 seconds
[0m17:08:57.014773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21a35f7140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21a3557fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2177db7800>]}
[0m17:08:57.015212 [debug] [MainThread]: Flushing usage events
